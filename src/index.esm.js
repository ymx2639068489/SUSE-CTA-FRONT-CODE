class BaseHttpRequest{config;constructor(e){this.config=e}}class ApiError extends Error{url;status;statusText;body;request;constructor(e,t,r){super(r),this.name="ApiError",this.url=t.url,this.status=t.status,this.statusText=t.statusText,this.body=t.body,this.request=e}}class CancelError extends Error{constructor(e){super(e),this.name="CancelError"}get isCancelled(){return!0}}class CancelablePromise{[Symbol.toStringTag];_isResolved;_isRejected;_isCancelled;_cancelHandlers;_promise;_resolve;_reject;constructor(e){this._isResolved=!1,this._isRejected=!1,this._isCancelled=!1,this._cancelHandlers=[],this._promise=new Promise(((t,r)=>{this._resolve=t,this._reject=r;const o=e=>{this._isResolved||this._isRejected||this._isCancelled||this._cancelHandlers.push(e)};return Object.defineProperty(o,"isResolved",{get:()=>this._isResolved}),Object.defineProperty(o,"isRejected",{get:()=>this._isRejected}),Object.defineProperty(o,"isCancelled",{get:()=>this._isCancelled}),e((e=>{this._isResolved||this._isRejected||this._isCancelled||(this._isResolved=!0,this._resolve?.(e))}),(e=>{this._isResolved||this._isRejected||this._isCancelled||(this._isRejected=!0,this._reject?.(e))}),o)}))}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(){if(!(this._isResolved||this._isRejected||this._isCancelled)){if(this._isCancelled=!0,this._cancelHandlers.length)try{for(const e of this._cancelHandlers)e()}catch(e){return void console.warn("Cancellation threw an error",e)}this._cancelHandlers.length=0,this._reject?.(new CancelError("Request aborted"))}}get isCancelled(){return this._isCancelled}}const isDefined$1=e=>null!=e,isString$1=e=>"string"==typeof e,isStringWithValue$1=e=>isString$1(e)&&""!==e,isBlob$1=e=>"object"==typeof e&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.arrayBuffer&&"function"==typeof e.constructor&&"string"==typeof e.constructor.name&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag]),isFormData$1=e=>e instanceof FormData,isSuccess$1=e=>e>=200&&e<300,base64$1=e=>{try{return btoa(e)}catch(t){return Buffer.from(e).toString("base64")}},getQueryString$1=e=>{const t=[],r=(e,o)=>{isDefined$1(o)&&(Array.isArray(o)?o.forEach((t=>{r(e,t)})):"object"==typeof o?Object.entries(o).forEach((([t,o])=>{r(`${e}[${t}]`,o)})):((e,r)=>{t.push(`${encodeURIComponent(e)}=${encodeURIComponent(String(r))}`)})(e,o))};return Object.entries(e).forEach((([e,t])=>{r(e,t)})),t.length>0?`?${t.join("&")}`:""},getUrl$1=(e,t)=>{const r=e.ENCODE_PATH||encodeURI,o=t.url.replace("{api-version}",e.VERSION).replace(/{(.*?)}/g,((e,o)=>t.path?.hasOwnProperty(o)?r(String(t.path[o])):e)),n=`${e.BASE}${o}`;return t.query?`${n}${getQueryString$1(t.query)}`:n},getFormData$1=e=>{if(e.formData){const t=new FormData,r=(e,r)=>{isString$1(r)||isBlob$1(r)?t.append(e,r):t.append(e,JSON.stringify(r))};return Object.entries(e.formData).filter((([e,t])=>isDefined$1(t))).forEach((([e,t])=>{Array.isArray(t)?t.forEach((t=>r(e,t))):r(e,t)})),t}},resolve$1=async(e,t)=>"function"==typeof t?t(e):t,getHeaders$1=async(e,t)=>{const r=await resolve$1(t,e.TOKEN),o=await resolve$1(t,e.USERNAME),n=await resolve$1(t,e.PASSWORD),i=await resolve$1(t,e.HEADERS),a=Object.entries({Accept:"application/json",...i,...t.headers}).filter((([e,t])=>isDefined$1(t))).reduce(((e,[t,r])=>({...e,[t]:String(r)})),{});if(isStringWithValue$1(r)&&(a.Authorization=`Bearer ${r}`),isStringWithValue$1(o)&&isStringWithValue$1(n)){const e=base64$1(`${o}:${n}`);a.Authorization=`Basic ${e}`}return t.body&&(t.mediaType?a["Content-Type"]=t.mediaType:isBlob$1(t.body)?a["Content-Type"]=t.body.type||"application/octet-stream":isString$1(t.body)?a["Content-Type"]="text/plain":isFormData$1(t.body)||(a["Content-Type"]="application/json")),new Headers(a)},getRequestBody$1=e=>{if(e.body)return e.mediaType?.includes("/json")?JSON.stringify(e.body):isString$1(e.body)||isBlob$1(e.body)||isFormData$1(e.body)?e.body:JSON.stringify(e.body)},sendRequest$1=async(e,t,r,o,n,i,a)=>{const s=new XMLHttpRequest;return s.open(t.method,r,!0),s.withCredentials=e.WITH_CREDENTIALS,i.forEach(((e,t)=>{s.setRequestHeader(t,e)})),new Promise(((e,t)=>{s.onload=()=>e(s),s.onabort=()=>t(new Error("Request aborted")),s.onerror=()=>t(new Error("Network error")),s.send(o??n),a((()=>s.abort()))}))},getResponseHeader$1=(e,t)=>{if(t){const r=e.getResponseHeader(t);if(isString$1(r))return r}},getResponseBody$1=e=>{if(204!==e.status)try{const t=e.getResponseHeader("Content-Type");if(t){return t.toLowerCase().startsWith("application/json")?JSON.parse(e.responseText):e.responseText}}catch(e){console.error(e)}},catchErrorCodes$1=(e,t)=>{const r={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",...e.errors}[t.status];if(r)throw new ApiError(e,t,r);if(!t.ok)throw new ApiError(e,t,"Generic Error")},request$1=(e,t)=>new CancelablePromise((async(r,o,n)=>{try{const o=getUrl$1(e,t),i=getFormData$1(t),a=getRequestBody$1(t),s=await getHeaders$1(e,t);if(!n.isCancelled){const c=await sendRequest$1(e,t,o,a,i,s,n),d=getResponseBody$1(c),l=getResponseHeader$1(c,t.responseHeader),u={url:o,ok:isSuccess$1(c.status),status:c.status,statusText:c.statusText,body:l??d};catchErrorCodes$1(t,u),r(u.body)}}catch(e){o(e)}}));class XHRHttpRequest extends BaseHttpRequest{constructor(e){super(e)}request(e){return request$1(this.config,e)}}class Service{httpRequest;constructor(e){this.httpRequest=e}postPerformancesBasicindicators({requestBody:e}){return this.httpRequest.request({method:"POST",url:"/performances/basicindicators",body:e,mediaType:"application/json"})}postPerformancesInterfaceindicators({requestBody:e}){return this.httpRequest.request({method:"POST",url:"/performances/interfaceindicators",body:e,mediaType:"application/json"})}postPerformancesResourceindicators({requestBody:e}){return this.httpRequest.request({method:"POST",url:"/performances/resourceindicators",body:e,mediaType:"application/json"})}postErrorsResourceerrors({requestBody:e}){return this.httpRequest.request({method:"POST",url:"/errors/resourceerrors",body:e,mediaType:"application/json"})}postErrorsJavascripterrors({requestBody:e}){return this.httpRequest.request({method:"POST",url:"/errors/javascripterrors",body:e,mediaType:"application/json"})}postErrorsPromiseerrors({requestBody:e}){return this.httpRequest.request({method:"POST",url:"/errors/promiseerrors",body:e,mediaType:"application/json"})}postBehaviorsBasicbehaviors({requestBody:e}){return this.httpRequest.request({method:"POST",url:"/behaviors/basicbehaviors",body:e,mediaType:"application/json"})}postBehaviorsClickbehaviors({requestBody:e}){return this.httpRequest.request({method:"POST",url:"/behaviors/clickbehaviors",body:e,mediaType:"application/json"})}postBehaviorsPageskipbehaviors({requestBody:e}){return this.httpRequest.request({method:"POST",url:"/behaviors/pageskipbehaviors",body:e,mediaType:"application/json"})}postBehaviorsRoutingskipbehaviors({requestBody:e}){return this.httpRequest.request({method:"POST",url:"/behaviors/routingskipbehaviors",body:e,mediaType:"application/json"})}postReplayReport({requestBody:e}){return this.httpRequest.request({method:"POST",url:"/replay/report",body:e,mediaType:"application/json"})}}class MonitorApiClient{service;request;constructor(e,t=XHRHttpRequest){this.request=new t({BASE:e?.BASE??"",VERSION:e?.VERSION??"1.0.0",WITH_CREDENTIALS:e?.WITH_CREDENTIALS??!1,CREDENTIALS:e?.CREDENTIALS??"include",TOKEN:e?.TOKEN,USERNAME:e?.USERNAME,PASSWORD:e?.PASSWORD,HEADERS:e?.HEADERS,ENCODE_PATH:e?.ENCODE_PATH}),this.service=new Service(this.request)}}var BasicBehavior,BasicIndicator,ClickBehavior,InterfaceIndicator,JavaScriptError,PageSkipBehavior,PromiseError,ResourceError,ResourceIndicator,RoutingSkipBehavior;!function(e){var t,r;(t=e.mainType||(e.mainType={}))[t.BasicBehavior=1]="BasicBehavior",t[t.ClickBehavior=2]="ClickBehavior",t[t.PageSkipBehavior=3]="PageSkipBehavior",t[t.RoutingSkipBehavior=4]="RoutingSkipBehavior",(r=e.subType||(e.subType={}))[r.PV=1001]="PV",r[r.UV=1002]="UV",r[r.PageDwellTime=1003]="PageDwellTime",r[r.PageAccessDepth=1004]="PageAccessDepth",r[r.ClickBehavior=2001]="ClickBehavior",r[r.PageSkipBehavior=3001]="PageSkipBehavior",r[r.RoutingSkipBehavior=4001]="RoutingSkipBehavior"}(BasicBehavior||(BasicBehavior={})),function(e){var t,r;(t=e.mainType||(e.mainType={}))[t.Performance=1]="Performance",t[t.LoadIndicator=2]="LoadIndicator",t[t.DrawIndicator=3]="DrawIndicator",t[t.OperationIndicator=4]="OperationIndicator",t[t.InterfaceIndicator=5]="InterfaceIndicator",t[t.ResourceIndicator=6]="ResourceIndicator",(r=e.subType||(e.subType={}))[r.FirstPaint=1001]="FirstPaint",r[r.FirstContentfulPaint=1002]="FirstContentfulPaint",r[r.LargestContentfulPaint=1003]="LargestContentfulPaint",r[r.LayoutShift=1004]="LayoutShift",r[r.DOMContentLoaded=2001]="DOMContentLoaded",r[r.FullLoad=2002]="FullLoad",r[r.FirstScreenLoad=3001]="FirstScreenLoad",r[r.FramesPerSecond=4001]="FramesPerSecond",r[r.RouterLoadTime=4002]="RouterLoadTime",r[r.InterfaceIndicator=5001]="InterfaceIndicator",r[r.ResourceIndicator=6001]="ResourceIndicator"}(BasicIndicator||(BasicIndicator={})),function(e){var t,r;(t=e.mainType||(e.mainType={}))[t.BasicBehavior=1]="BasicBehavior",t[t.ClickBehavior=2]="ClickBehavior",t[t.PageSkipBehavior=3]="PageSkipBehavior",t[t.RoutingSkipBehavior=4]="RoutingSkipBehavior",(r=e.subType||(e.subType={}))[r.PV=1001]="PV",r[r.UV=1002]="UV",r[r.PageDwellTime=1003]="PageDwellTime",r[r.PageAccessDepth=1004]="PageAccessDepth",r[r.ClickBehavior=2001]="ClickBehavior",r[r.PageSkipBehavior=3001]="PageSkipBehavior",r[r.RoutingSkipBehavior=4001]="RoutingSkipBehavior"}(ClickBehavior||(ClickBehavior={})),function(e){var t,r;(t=e.mainType||(e.mainType={}))[t.Performance=1]="Performance",t[t.LoadIndicator=2]="LoadIndicator",t[t.DrawIndicator=3]="DrawIndicator",t[t.OperationIndicator=4]="OperationIndicator",t[t.InterfaceIndicator=5]="InterfaceIndicator",t[t.ResourceIndicator=6]="ResourceIndicator",(r=e.subType||(e.subType={}))[r.FirstPaint=1001]="FirstPaint",r[r.FirstContentfulPaint=1002]="FirstContentfulPaint",r[r.LargestContentfulPaint=1003]="LargestContentfulPaint",r[r.LayoutShift=1004]="LayoutShift",r[r.DOMContentLoaded=2001]="DOMContentLoaded",r[r.FullLoad=2002]="FullLoad",r[r.FirstScreenLoad=3001]="FirstScreenLoad",r[r.FramesPerSecond=4001]="FramesPerSecond",r[r.RouterLoadTime=4002]="RouterLoadTime",r[r.InterfaceIndicator=5001]="InterfaceIndicator",r[r.ResourceIndicator=6001]="ResourceIndicator"}(InterfaceIndicator||(InterfaceIndicator={})),function(e){var t,r;(t=e.mainType||(e.mainType={}))[t.ResourceError=1]="ResourceError",t[t.JavaScriptError=2]="JavaScriptError",t[t.PromiseError=3]="PromiseError",t[t.VueError=4]="VueError",(r=e.subType||(e.subType={}))[r.ResourceError=1001]="ResourceError",r[r.JavaScriptError=2001]="JavaScriptError",r[r.PromiseError=3001]="PromiseError",r[r.VueError=4001]="VueError"}(JavaScriptError||(JavaScriptError={})),function(e){var t,r;(t=e.mainType||(e.mainType={}))[t.BasicBehavior=1]="BasicBehavior",t[t.ClickBehavior=2]="ClickBehavior",t[t.PageSkipBehavior=3]="PageSkipBehavior",t[t.RoutingSkipBehavior=4]="RoutingSkipBehavior",(r=e.subType||(e.subType={}))[r.PV=1001]="PV",r[r.UV=1002]="UV",r[r.PageDwellTime=1003]="PageDwellTime",r[r.PageAccessDepth=1004]="PageAccessDepth",r[r.ClickBehavior=2001]="ClickBehavior",r[r.PageSkipBehavior=3001]="PageSkipBehavior",r[r.RoutingSkipBehavior=4001]="RoutingSkipBehavior"}(PageSkipBehavior||(PageSkipBehavior={})),function(e){var t,r;(t=e.mainType||(e.mainType={}))[t.ResourceError=1]="ResourceError",t[t.JavaScriptError=2]="JavaScriptError",t[t.PromiseError=3]="PromiseError",t[t.VueError=4]="VueError",(r=e.subType||(e.subType={}))[r.ResourceError=1001]="ResourceError",r[r.JavaScriptError=2001]="JavaScriptError",r[r.PromiseError=3001]="PromiseError",r[r.VueError=4001]="VueError"}(PromiseError||(PromiseError={})),function(e){var t,r;(t=e.mainType||(e.mainType={}))[t.ResourceError=1]="ResourceError",t[t.JavaScriptError=2]="JavaScriptError",t[t.PromiseError=3]="PromiseError",t[t.VueError=4]="VueError",(r=e.subType||(e.subType={}))[r.ResourceError=1001]="ResourceError",r[r.JavaScriptError=2001]="JavaScriptError",r[r.PromiseError=3001]="PromiseError",r[r.VueError=4001]="VueError"}(ResourceError||(ResourceError={})),function(e){var t,r;(t=e.mainType||(e.mainType={}))[t.Performance=1]="Performance",t[t.LoadIndicator=2]="LoadIndicator",t[t.DrawIndicator=3]="DrawIndicator",t[t.OperationIndicator=4]="OperationIndicator",t[t.InterfaceIndicator=5]="InterfaceIndicator",t[t.ResourceIndicator=6]="ResourceIndicator",(r=e.subType||(e.subType={}))[r.FirstPaint=1001]="FirstPaint",r[r.FirstContentfulPaint=1002]="FirstContentfulPaint",r[r.LargestContentfulPaint=1003]="LargestContentfulPaint",r[r.LayoutShift=1004]="LayoutShift",r[r.DOMContentLoaded=2001]="DOMContentLoaded",r[r.FullLoad=2002]="FullLoad",r[r.FirstScreenLoad=3001]="FirstScreenLoad",r[r.FramesPerSecond=4001]="FramesPerSecond",r[r.RouterLoadTime=4002]="RouterLoadTime",r[r.InterfaceIndicator=5001]="InterfaceIndicator",r[r.ResourceIndicator=6001]="ResourceIndicator"}(ResourceIndicator||(ResourceIndicator={})),function(e){var t,r;(t=e.mainType||(e.mainType={}))[t.BasicBehavior=1]="BasicBehavior",t[t.ClickBehavior=2]="ClickBehavior",t[t.PageSkipBehavior=3]="PageSkipBehavior",t[t.RoutingSkipBehavior=4]="RoutingSkipBehavior",(r=e.subType||(e.subType={}))[r.PV=1001]="PV",r[r.UV=1002]="UV",r[r.PageDwellTime=1003]="PageDwellTime",r[r.PageAccessDepth=1004]="PageAccessDepth",r[r.ClickBehavior=2001]="ClickBehavior",r[r.PageSkipBehavior=3001]="PageSkipBehavior",r[r.RoutingSkipBehavior=4001]="RoutingSkipBehavior"}(RoutingSkipBehavior||(RoutingSkipBehavior={}));const isDefined=e=>null!=e,isString=e=>"string"==typeof e,isStringWithValue=e=>isString(e)&&""!==e,isBlob=e=>"object"==typeof e&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.arrayBuffer&&"function"==typeof e.constructor&&"string"==typeof e.constructor.name&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag]),isFormData=e=>e instanceof FormData,isSuccess=e=>e>=200&&e<300,base64=e=>{try{return btoa(e)}catch(t){return Buffer.from(e).toString("base64")}},getQueryString=e=>{const t=[],r=(e,o)=>{isDefined(o)&&(Array.isArray(o)?o.forEach((t=>{r(e,t)})):"object"==typeof o?Object.entries(o).forEach((([t,o])=>{r(`${e}[${t}]`,o)})):((e,r)=>{t.push(`${encodeURIComponent(e)}=${encodeURIComponent(String(r))}`)})(e,o))};return Object.entries(e).forEach((([e,t])=>{r(e,t)})),t.length>0?`?${t.join("&")}`:""},getUrl=(e,t)=>{const r=e.ENCODE_PATH||encodeURI,o=t.url.replace("{api-version}",e.VERSION).replace(/{(.*?)}/g,((e,o)=>t.path?.hasOwnProperty(o)?r(String(t.path[o])):e)),n=`${e.BASE}${o}`;return t.query?`${n}${getQueryString(t.query)}`:n},getFormData=e=>{if(e.formData){const t=new FormData,r=(e,r)=>{isString(r)||isBlob(r)?t.append(e,r):t.append(e,JSON.stringify(r))};return Object.entries(e.formData).filter((([e,t])=>isDefined(t))).forEach((([e,t])=>{Array.isArray(t)?t.forEach((t=>r(e,t))):r(e,t)})),t}},resolve=async(e,t)=>"function"==typeof t?t(e):t,getHeaders=async(e,t)=>{const r=await resolve(t,e.TOKEN),o=await resolve(t,e.USERNAME),n=await resolve(t,e.PASSWORD),i=await resolve(t,e.HEADERS),a=Object.entries({Accept:"application/json",...i,...t.headers}).filter((([e,t])=>isDefined(t))).reduce(((e,[t,r])=>({...e,[t]:String(r)})),{});if(isStringWithValue(r)&&(a.Authorization=`Bearer ${r}`),isStringWithValue(o)&&isStringWithValue(n)){const e=base64(`${o}:${n}`);a.Authorization=`Basic ${e}`}return t.body&&(t.mediaType?a["Content-Type"]=t.mediaType:isBlob(t.body)?a["Content-Type"]=t.body.type||"application/octet-stream":isString(t.body)?a["Content-Type"]="text/plain":isFormData(t.body)||(a["Content-Type"]="application/json")),new Headers(a)},getRequestBody=e=>{if(e.body)return e.mediaType?.includes("/json")?JSON.stringify(e.body):isString(e.body)||isBlob(e.body)||isFormData(e.body)?e.body:JSON.stringify(e.body)},sendRequest=async(e,t,r,o,n,i,a,s,c)=>{const d=new XMLHttpRequest;return s.call(d,t.method,r,!0),d.withCredentials=e.WITH_CREDENTIALS,i.forEach(((e,t)=>{d.setRequestHeader(t,e)})),new Promise(((e,t)=>{d.onload=()=>e(d),d.onabort=()=>t(new Error("Request aborted")),d.onerror=()=>t(new Error("Network error")),c.call(d,o??n),a((()=>d.abort()))}))},getResponseHeader=(e,t)=>{if(t){const r=e.getResponseHeader(t);if(isString(r))return r}},getResponseBody=e=>{if(204!==e.status)try{const t=e.getResponseHeader("Content-Type");if(t){return t.toLowerCase().startsWith("application/json")?JSON.parse(e.responseText):e.responseText}}catch(e){console.error(e)}},catchErrorCodes=(e,t)=>{const r={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",...e.errors}[t.status];if(r)throw new ApiError(e,t,r);if(!t.ok)throw new ApiError(e,t,"Generic Error")},request=(e,t,r,o)=>new CancelablePromise((async(n,i,a)=>{try{const i=getUrl(e,t),s=getFormData(t),c=getRequestBody(t),d=await getHeaders(e,t);if(!a.isCancelled){const l=await sendRequest(e,t,i,c,s,d,a,r,o),u=getResponseBody(l),p=getResponseHeader(l,t.responseHeader),h={url:i,ok:isSuccess(l.status),status:l.status,statusText:l.statusText,body:p??u};catchErrorCodes(t,h),n(h.body)}}catch(e){i(e)}})),originalProto=XMLHttpRequest.prototype,originalOpen=originalProto.open,originalSend=originalProto.send;class OriginHttpRequest extends BaseHttpRequest{request(e){return request(this.config,e,originalOpen,originalSend)}}const client=new MonitorApiClient({},OriginHttpRequest);let{postBehaviorsBasicbehaviors:postBehaviorsBasicbehaviors,postBehaviorsClickbehaviors:postBehaviorsClickbehaviors,postBehaviorsPageskipbehaviors:postBehaviorsPageskipbehaviors,postBehaviorsRoutingskipbehaviors:postBehaviorsRoutingskipbehaviors,postErrorsJavascripterrors:postErrorsJavascripterrors,postErrorsPromiseerrors:postErrorsPromiseerrors,postErrorsResourceerrors:postErrorsResourceerrors,postPerformancesBasicindicators:postPerformancesBasicindicators,postPerformancesInterfaceindicators:postPerformancesInterfaceindicators,postPerformancesResourceindicators:postPerformancesResourceindicators,postReplayReport:postReplayReport}=client.service;postBehaviorsBasicbehaviors=postBehaviorsBasicbehaviors.bind(client.service),postBehaviorsClickbehaviors=postBehaviorsClickbehaviors.bind(client.service),postBehaviorsPageskipbehaviors=postBehaviorsPageskipbehaviors.bind(client.service),postBehaviorsRoutingskipbehaviors=postBehaviorsRoutingskipbehaviors.bind(client.service),postErrorsJavascripterrors=postErrorsJavascripterrors.bind(client.service),postErrorsPromiseerrors=postErrorsPromiseerrors.bind(client.service),postErrorsResourceerrors=postErrorsResourceerrors.bind(client.service),postPerformancesBasicindicators=postPerformancesBasicindicators.bind(client.service),postPerformancesInterfaceindicators=postPerformancesInterfaceindicators.bind(client.service),postPerformancesResourceindicators=postPerformancesResourceindicators.bind(client.service),postReplayReport=postReplayReport.bind(client.service);let config={url:"http://localhost:8080/api/v1/monitor",appId:"5e8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8",userId:"5e8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8",cacheMapSize:30,reportTimeInterval:5e3};const setConfig=e=>{config={...config,...e},client.service.httpRequest.config.BASE=config.url},getConfig=()=>config,monitoring=(...e)=>{for(const t of e)t()};var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},md5$1={exports:{}};
/**
 * [js-md5]{@link https://github.com/emn178/js-md5}
 *
 * @namespace md5
 * @version 0.7.3
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */
(function(module){(function(){var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_MD5_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_MD5_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=commonjsGlobal:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_MD5_NO_COMMON_JS&&module.exports,ARRAY_BUFFER=!root.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[128,32768,8388608,-2147483648],SHIFT=[0,8,16,24],OUTPUT_TYPES=["hex","array","digest","buffer","arrayBuffer","base64"],BASE64_ENCODE_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),blocks=[],buffer8;if(ARRAY_BUFFER){var buffer=new ArrayBuffer(68);buffer8=new Uint8Array(buffer),blocks=new Uint32Array(buffer)}!root.JS_MD5_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!ARRAY_BUFFER||!root.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(e){return function(t){return new Md5(!0).update(t)[e]()}},createMethod=function(){var e=createOutputMethod("hex");NODE_JS&&(e=nodeWrap(e)),e.create=function(){return new Md5},e.update=function(t){return e.create().update(t)};for(var t=0;t<OUTPUT_TYPES.length;++t){var r=OUTPUT_TYPES[t];e[r]=createOutputMethod(r)}return e},nodeWrap=function(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(e){if("string"==typeof e)return crypto.createHash("md5").update(e,"utf8").digest("hex");if(null==e)throw ERROR;return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash("md5").update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod};function Md5(e){if(e)blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks,this.buffer8=buffer8;else if(ARRAY_BUFFER){var t=new ArrayBuffer(68);this.buffer8=new Uint8Array(t),this.blocks=new Uint32Array(t)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Md5.prototype.update=function(e){if(!this.finalized){var t,r=typeof e;if("string"!==r){if("object"!==r)throw ERROR;if(null===e)throw ERROR;if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw ERROR;t=!0}for(var o,n,i=0,a=e.length,s=this.blocks,c=this.buffer8;i<a;){if(this.hashed&&(this.hashed=!1,s[0]=s[16],s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),t)if(ARRAY_BUFFER)for(n=this.start;i<a&&n<64;++i)c[n++]=e[i];else for(n=this.start;i<a&&n<64;++i)s[n>>2]|=e[i]<<SHIFT[3&n++];else if(ARRAY_BUFFER)for(n=this.start;i<a&&n<64;++i)(o=e.charCodeAt(i))<128?c[n++]=o:o<2048?(c[n++]=192|o>>6,c[n++]=128|63&o):o<55296||o>=57344?(c[n++]=224|o>>12,c[n++]=128|o>>6&63,c[n++]=128|63&o):(o=65536+((1023&o)<<10|1023&e.charCodeAt(++i)),c[n++]=240|o>>18,c[n++]=128|o>>12&63,c[n++]=128|o>>6&63,c[n++]=128|63&o);else for(n=this.start;i<a&&n<64;++i)(o=e.charCodeAt(i))<128?s[n>>2]|=o<<SHIFT[3&n++]:o<2048?(s[n>>2]|=(192|o>>6)<<SHIFT[3&n++],s[n>>2]|=(128|63&o)<<SHIFT[3&n++]):o<55296||o>=57344?(s[n>>2]|=(224|o>>12)<<SHIFT[3&n++],s[n>>2]|=(128|o>>6&63)<<SHIFT[3&n++],s[n>>2]|=(128|63&o)<<SHIFT[3&n++]):(o=65536+((1023&o)<<10|1023&e.charCodeAt(++i)),s[n>>2]|=(240|o>>18)<<SHIFT[3&n++],s[n>>2]|=(128|o>>12&63)<<SHIFT[3&n++],s[n>>2]|=(128|o>>6&63)<<SHIFT[3&n++],s[n>>2]|=(128|63&o)<<SHIFT[3&n++]);this.lastByteIndex=n,this.bytes+=n-this.start,n>=64?(this.start=n-64,this.hash(),this.hashed=!0):this.start=n}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Md5.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[t>>2]|=EXTRA[3&t],t>=56&&(this.hashed||this.hash(),e[0]=e[16],e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.bytes<<3,e[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},Md5.prototype.hash=function(){var e,t,r,o,n,i,a=this.blocks;this.first?t=((t=((e=((e=a[0]-680876937)<<7|e>>>25)-271733879<<0)^(r=((r=(-271733879^(o=((o=(-1732584194^2004318071&e)+a[1]-117830708)<<12|o>>>20)+e<<0)&(-271733879^e))+a[2]-1126478375)<<17|r>>>15)+o<<0)&(o^e))+a[3]-1316259209)<<22|t>>>10)+r<<0:(e=this.h0,t=this.h1,r=this.h2,t=((t+=((e=((e+=((o=this.h3)^t&(r^o))+a[0]-680876936)<<7|e>>>25)+t<<0)^(r=((r+=(t^(o=((o+=(r^e&(t^r))+a[1]-389564586)<<12|o>>>20)+e<<0)&(e^t))+a[2]+606105819)<<17|r>>>15)+o<<0)&(o^e))+a[3]-1044525330)<<22|t>>>10)+r<<0),t=((t+=((e=((e+=(o^t&(r^o))+a[4]-176418897)<<7|e>>>25)+t<<0)^(r=((r+=(t^(o=((o+=(r^e&(t^r))+a[5]+1200080426)<<12|o>>>20)+e<<0)&(e^t))+a[6]-1473231341)<<17|r>>>15)+o<<0)&(o^e))+a[7]-45705983)<<22|t>>>10)+r<<0,t=((t+=((e=((e+=(o^t&(r^o))+a[8]+1770035416)<<7|e>>>25)+t<<0)^(r=((r+=(t^(o=((o+=(r^e&(t^r))+a[9]-1958414417)<<12|o>>>20)+e<<0)&(e^t))+a[10]-42063)<<17|r>>>15)+o<<0)&(o^e))+a[11]-1990404162)<<22|t>>>10)+r<<0,t=((t+=((e=((e+=(o^t&(r^o))+a[12]+1804603682)<<7|e>>>25)+t<<0)^(r=((r+=(t^(o=((o+=(r^e&(t^r))+a[13]-40341101)<<12|o>>>20)+e<<0)&(e^t))+a[14]-1502002290)<<17|r>>>15)+o<<0)&(o^e))+a[15]+1236535329)<<22|t>>>10)+r<<0,t=((t+=((o=((o+=(t^r&((e=((e+=(r^o&(t^r))+a[1]-165796510)<<5|e>>>27)+t<<0)^t))+a[6]-1069501632)<<9|o>>>23)+e<<0)^e&((r=((r+=(e^t&(o^e))+a[11]+643717713)<<14|r>>>18)+o<<0)^o))+a[0]-373897302)<<20|t>>>12)+r<<0,t=((t+=((o=((o+=(t^r&((e=((e+=(r^o&(t^r))+a[5]-701558691)<<5|e>>>27)+t<<0)^t))+a[10]+38016083)<<9|o>>>23)+e<<0)^e&((r=((r+=(e^t&(o^e))+a[15]-660478335)<<14|r>>>18)+o<<0)^o))+a[4]-405537848)<<20|t>>>12)+r<<0,t=((t+=((o=((o+=(t^r&((e=((e+=(r^o&(t^r))+a[9]+568446438)<<5|e>>>27)+t<<0)^t))+a[14]-1019803690)<<9|o>>>23)+e<<0)^e&((r=((r+=(e^t&(o^e))+a[3]-187363961)<<14|r>>>18)+o<<0)^o))+a[8]+1163531501)<<20|t>>>12)+r<<0,t=((t+=((o=((o+=(t^r&((e=((e+=(r^o&(t^r))+a[13]-1444681467)<<5|e>>>27)+t<<0)^t))+a[2]-51403784)<<9|o>>>23)+e<<0)^e&((r=((r+=(e^t&(o^e))+a[7]+1735328473)<<14|r>>>18)+o<<0)^o))+a[12]-1926607734)<<20|t>>>12)+r<<0,t=((t+=((i=(o=((o+=((n=t^r)^(e=((e+=(n^o)+a[5]-378558)<<4|e>>>28)+t<<0))+a[8]-2022574463)<<11|o>>>21)+e<<0)^e)^(r=((r+=(i^t)+a[11]+1839030562)<<16|r>>>16)+o<<0))+a[14]-35309556)<<23|t>>>9)+r<<0,t=((t+=((i=(o=((o+=((n=t^r)^(e=((e+=(n^o)+a[1]-1530992060)<<4|e>>>28)+t<<0))+a[4]+1272893353)<<11|o>>>21)+e<<0)^e)^(r=((r+=(i^t)+a[7]-155497632)<<16|r>>>16)+o<<0))+a[10]-1094730640)<<23|t>>>9)+r<<0,t=((t+=((i=(o=((o+=((n=t^r)^(e=((e+=(n^o)+a[13]+681279174)<<4|e>>>28)+t<<0))+a[0]-358537222)<<11|o>>>21)+e<<0)^e)^(r=((r+=(i^t)+a[3]-722521979)<<16|r>>>16)+o<<0))+a[6]+76029189)<<23|t>>>9)+r<<0,t=((t+=((i=(o=((o+=((n=t^r)^(e=((e+=(n^o)+a[9]-640364487)<<4|e>>>28)+t<<0))+a[12]-421815835)<<11|o>>>21)+e<<0)^e)^(r=((r+=(i^t)+a[15]+530742520)<<16|r>>>16)+o<<0))+a[2]-995338651)<<23|t>>>9)+r<<0,t=((t+=((o=((o+=(t^((e=((e+=(r^(t|~o))+a[0]-198630844)<<6|e>>>26)+t<<0)|~r))+a[7]+1126891415)<<10|o>>>22)+e<<0)^((r=((r+=(e^(o|~t))+a[14]-1416354905)<<15|r>>>17)+o<<0)|~e))+a[5]-57434055)<<21|t>>>11)+r<<0,t=((t+=((o=((o+=(t^((e=((e+=(r^(t|~o))+a[12]+1700485571)<<6|e>>>26)+t<<0)|~r))+a[3]-1894986606)<<10|o>>>22)+e<<0)^((r=((r+=(e^(o|~t))+a[10]-1051523)<<15|r>>>17)+o<<0)|~e))+a[1]-2054922799)<<21|t>>>11)+r<<0,t=((t+=((o=((o+=(t^((e=((e+=(r^(t|~o))+a[8]+1873313359)<<6|e>>>26)+t<<0)|~r))+a[15]-30611744)<<10|o>>>22)+e<<0)^((r=((r+=(e^(o|~t))+a[6]-1560198380)<<15|r>>>17)+o<<0)|~e))+a[13]+1309151649)<<21|t>>>11)+r<<0,t=((t+=((o=((o+=(t^((e=((e+=(r^(t|~o))+a[4]-145523070)<<6|e>>>26)+t<<0)|~r))+a[11]-1120210379)<<10|o>>>22)+e<<0)^((r=((r+=(e^(o|~t))+a[2]+718787259)<<15|r>>>17)+o<<0)|~e))+a[9]-343485551)<<21|t>>>11)+r<<0,this.first?(this.h0=e+1732584193<<0,this.h1=t-271733879<<0,this.h2=r-1732584194<<0,this.h3=o+271733878<<0,this.first=!1):(this.h0=this.h0+e<<0,this.h1=this.h1+t<<0,this.h2=this.h2+r<<0,this.h3=this.h3+o<<0)},Md5.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,o=this.h3;return HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]},Md5.prototype.toString=Md5.prototype.hex,Md5.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,o=this.h3;return[255&e,e>>8&255,e>>16&255,e>>24&255,255&t,t>>8&255,t>>16&255,t>>24&255,255&r,r>>8&255,r>>16&255,r>>24&255,255&o,o>>8&255,o>>16&255,o>>24&255]},Md5.prototype.array=Md5.prototype.digest,Md5.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(16),t=new Uint32Array(e);return t[0]=this.h0,t[1]=this.h1,t[2]=this.h2,t[3]=this.h3,e},Md5.prototype.buffer=Md5.prototype.arrayBuffer,Md5.prototype.base64=function(){for(var e,t,r,o="",n=this.array(),i=0;i<15;)e=n[i++],t=n[i++],r=n[i++],o+=BASE64_ENCODE_CHAR[e>>>2]+BASE64_ENCODE_CHAR[63&(e<<4|t>>>4)]+BASE64_ENCODE_CHAR[63&(t<<2|r>>>6)]+BASE64_ENCODE_CHAR[63&r];return e=n[i],o+=BASE64_ENCODE_CHAR[e>>>2]+BASE64_ENCODE_CHAR[e<<4&63]+"=="};var exports=createMethod();COMMON_JS?module.exports=exports:root.md5=exports})()})(md5$1);var md5=md5$1.exports;const getAppId=()=>getConfig().appId,getTimeStamp=()=>(new Date).getTime(),getPageUrl=()=>{const{location:{href:e}}=window;return e},getUserID=()=>getConfig().userId,getBasicParams=()=>{const e=getTimeStamp(),t=md5.hex(getAppId()+getUserID()+e);return{appId:getAppId(),startTime:e,pageUrl:getPageUrl(),userID:getUserID(),eventId:t}},beforeUnloadCallbacks=new Set,onBeforeUnload=e=>(beforeUnloadCallbacks.add(e),window.addEventListener("beforeunload",e,!0),()=>{window.removeEventListener("beforeunload",e,!0),beforeUnloadCallbacks.delete(e)}),hiddenCallbacks=new Set,onHidden=e=>{const t=()=>{"hidden"===document.visibilityState&&e()};return hiddenCallbacks.add(t),window.addEventListener("visibilitychange",t,!0),()=>{window.removeEventListener("visibilitychange",t,!0),hiddenCallbacks.delete(t)}};var NodeType$2;function isElement(e){return e.nodeType===e.ELEMENT_NODE}function isShadowRoot(e){var t=null==e?void 0:e.host;return Boolean((null==t?void 0:t.shadowRoot)===e)}function isNativeShadowDom(e){return"[object ShadowRoot]"===Object.prototype.toString.call(e)}function fixBrowserCompatibilityIssuesInCSS(e){return e.includes(" background-clip: text;")&&!e.includes(" -webkit-background-clip: text;")&&(e=e.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),e}function getCssRulesString(e){try{var t=e.rules||e.cssRules;return t?fixBrowserCompatibilityIssuesInCSS(Array.from(t).map(getCssRuleString).join("")):null}catch(e){return null}}function getCssRuleString(e){var t=e.cssText;if(isCSSImportRule(e))try{t=getCssRulesString(e.styleSheet)||t}catch(e){}return t}function isCSSImportRule(e){return"styleSheet"in e}!function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(NodeType$2||(NodeType$2={}));var Mirror=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(e){var t;if(!e)return-1;var r=null===(t=this.getMeta(e))||void 0===t?void 0:t.id;return null!=r?r:-1},e.prototype.getNode=function(e){return this.idNodeMap.get(e)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(e){return this.nodeMetaMap.get(e)||null},e.prototype.removeNodeFromMap=function(e){var t=this,r=this.getId(e);this.idNodeMap.delete(r),e.childNodes&&e.childNodes.forEach((function(e){return t.removeNodeFromMap(e)}))},e.prototype.has=function(e){return this.idNodeMap.has(e)},e.prototype.hasNode=function(e){return this.nodeMetaMap.has(e)},e.prototype.add=function(e,t){var r=t.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,t)},e.prototype.replace=function(e,t){var r=this.getNode(e);if(r){var o=this.nodeMetaMap.get(r);o&&this.nodeMetaMap.set(t,o)}this.idNodeMap.set(e,t)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function createMirror(){return new Mirror}function maskInputValue(e){var t=e.maskInputOptions,r=e.tagName,o=e.type,n=e.value,i=e.maskInputFn,a=n||"";return(t[r.toLowerCase()]||t[o])&&(a=i?i(a):"*".repeat(a.length)),a}var ORIGINAL_ATTRIBUTE_NAME="__rrweb_original__";function is2DCanvasBlank(e){var t=e.getContext("2d");if(!t)return!0;for(var r=0;r<e.width;r+=50)for(var o=0;o<e.height;o+=50){var n=t.getImageData,i=ORIGINAL_ATTRIBUTE_NAME in n?n[ORIGINAL_ATTRIBUTE_NAME]:n;if(new Uint32Array(i.call(t,r,o,Math.min(50,e.width-r),Math.min(50,e.height-o)).data.buffer).some((function(e){return 0!==e})))return!1}return!0}var _id=1,tagNameRegex=new RegExp("[^a-z0-9-_:]"),IGNORED_NODE=-2,canvasService,canvasCtx;function genId(){return _id++}function getValidTagName(e){if(e instanceof HTMLFormElement)return"form";var t=e.tagName.toLowerCase().trim();return tagNameRegex.test(t)?"div":t}function stringifyStyleSheet(e){return e.cssRules?Array.from(e.cssRules).map((function(e){return e.cssText||""})).join(""):""}function extractOrigin(e){return(e.indexOf("//")>-1?e.split("/").slice(0,3).join("/"):e.split("/")[0]).split("?")[0]}var URL_IN_CSS_REF=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,RELATIVE_PATH=/^(?!www\.|(?:http|ftp)s?:\/\/|[A-Za-z]:\\|\/\/|#).*/,DATA_URI=/^(data:)([^,]*),(.*)/i;function absoluteToStylesheet(e,t){return(e||"").replace(URL_IN_CSS_REF,(function(e,r,o,n,i,a){var s=o||i||a,c=r||n||"";if(!s)return e;if(!RELATIVE_PATH.test(s))return"url(".concat(c).concat(s).concat(c,")");if(DATA_URI.test(s))return"url(".concat(c).concat(s).concat(c,")");if("/"===s[0])return"url(".concat(c).concat(extractOrigin(t)+s).concat(c,")");var d=t.split("/"),l=s.split("/");d.pop();for(var u=0,p=l;u<p.length;u++){var h=p[u];"."!==h&&(".."===h?d.pop():d.push(h))}return"url(".concat(c).concat(d.join("/")).concat(c,")")}))}var SRCSET_NOT_SPACES=/^[^ \t\n\r\u000c]+/,SRCSET_COMMAS_OR_SPACES=/^[, \t\n\r\u000c]+/;function getAbsoluteSrcsetString(e,t){if(""===t.trim())return t;var r=0;function o(e){var o,n=e.exec(t.substring(r));return n?(o=n[0],r+=o.length,o):""}for(var n=[];o(SRCSET_COMMAS_OR_SPACES),!(r>=t.length);){var i=o(SRCSET_NOT_SPACES);if(","===i.slice(-1))i=absoluteToDoc(e,i.substring(0,i.length-1)),n.push(i);else{var a="";i=absoluteToDoc(e,i);for(var s=!1;;){var c=t.charAt(r);if(""===c){n.push((i+a).trim());break}if(s)")"===c&&(s=!1);else{if(","===c){r+=1,n.push((i+a).trim());break}"("===c&&(s=!0)}a+=c,r+=1}}}return n.join(", ")}function absoluteToDoc(e,t){if(!t||""===t.trim())return t;var r=e.createElement("a");return r.href=t,r.href}function isSVGElement(e){return Boolean("svg"===e.tagName||e.ownerSVGElement)}function getHref(){var e=document.createElement("a");return e.href="",e.href}function transformAttribute(e,t,r,o){return"src"===r||"href"===r&&o&&("use"!==t||"#"!==o[0])||"xlink:href"===r&&o&&"#"!==o[0]?absoluteToDoc(e,o):"background"!==r||!o||"table"!==t&&"td"!==t&&"th"!==t?"srcset"===r&&o?getAbsoluteSrcsetString(e,o):"style"===r&&o?absoluteToStylesheet(o,getHref()):"object"===t&&"data"===r&&o?absoluteToDoc(e,o):o:absoluteToDoc(e,o)}function _isBlockedElement(e,t,r){if("string"==typeof t){if(e.classList.contains(t))return!0}else for(var o=e.classList.length;o--;){var n=e.classList[o];if(t.test(n))return!0}return!!r&&e.matches(r)}function classMatchesRegex(e,t,r){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return!!r&&classMatchesRegex(e.parentNode,t,r);for(var o=e.classList.length;o--;){var n=e.classList[o];if(t.test(n))return!0}return!!r&&classMatchesRegex(e.parentNode,t,r)}function needMaskingText(e,t,r){var o=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(null===o)return!1;if("string"==typeof t){if(o.classList.contains(t))return!0;if(o.closest(".".concat(t)))return!0}else if(classMatchesRegex(o,t,!0))return!0;if(r){if(o.matches(r))return!0;if(o.closest(r))return!0}return!1}function onceIframeLoaded(e,t,r){var o=e.contentWindow;if(o){var n,i=!1;try{n=o.document.readyState}catch(e){return}if("complete"===n){var a="about:blank";if(o.location.href!==a||e.src===a||""===e.src)return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}else{var s=setTimeout((function(){i||(t(),i=!0)}),r);e.addEventListener("load",(function(){clearTimeout(s),i=!0,t()}))}}}function onceStylesheetLoaded(e,t,r){var o,n=!1;try{o=e.sheet}catch(e){return}if(!o){var i=setTimeout((function(){n||(t(),n=!0)}),r);e.addEventListener("load",(function(){clearTimeout(i),n=!0,t()}))}}function serializeNode(e,t){var r=t.doc,o=t.mirror,n=t.blockClass,i=t.blockSelector,a=t.maskTextClass,s=t.maskTextSelector,c=t.inlineStylesheet,d=t.maskInputOptions,l=void 0===d?{}:d,u=t.maskTextFn,p=t.maskInputFn,h=t.dataURLOptions,g=void 0===h?{}:h,m=t.inlineImages,f=t.recordCanvas,I=t.keepIframeSrcFn,y=t.newlyAddedElement,S=void 0!==y&&y,C=getRootId(r,o);switch(e.nodeType){case e.DOCUMENT_NODE:return"CSS1Compat"!==e.compatMode?{type:NodeType$2.Document,childNodes:[],compatMode:e.compatMode}:{type:NodeType$2.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:NodeType$2.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:C};case e.ELEMENT_NODE:return serializeElementNode(e,{doc:r,blockClass:n,blockSelector:i,inlineStylesheet:c,maskInputOptions:l,maskInputFn:p,dataURLOptions:g,inlineImages:m,recordCanvas:f,keepIframeSrcFn:I,newlyAddedElement:S,rootId:C});case e.TEXT_NODE:return serializeTextNode(e,{maskTextClass:a,maskTextSelector:s,maskTextFn:u,rootId:C});case e.CDATA_SECTION_NODE:return{type:NodeType$2.CDATA,textContent:"",rootId:C};case e.COMMENT_NODE:return{type:NodeType$2.Comment,textContent:e.textContent||"",rootId:C};default:return!1}}function getRootId(e,t){if(t.hasNode(e)){var r=t.getId(e);return 1===r?void 0:r}}function serializeTextNode(e,t){var r,o=t.maskTextClass,n=t.maskTextSelector,i=t.maskTextFn,a=t.rootId,s=e.parentNode&&e.parentNode.tagName,c=e.textContent,d="STYLE"===s||void 0,l="SCRIPT"===s||void 0;if(d&&c){try{e.nextSibling||e.previousSibling||(null===(r=e.parentNode.sheet)||void 0===r?void 0:r.cssRules)&&(c=stringifyStyleSheet(e.parentNode.sheet))}catch(t){console.warn("Cannot get CSS styles from text's parentNode. Error: ".concat(t),e)}c=absoluteToStylesheet(c,getHref())}return l&&(c="SCRIPT_PLACEHOLDER"),!d&&!l&&c&&needMaskingText(e,o,n)&&(c=i?i(c):c.replace(/[\S]/g,"*")),{type:NodeType$2.Text,textContent:c||"",isStyle:d,rootId:a}}function serializeElementNode(e,t){for(var r=t.doc,o=t.blockClass,n=t.blockSelector,i=t.inlineStylesheet,a=t.maskInputOptions,s=void 0===a?{}:a,c=t.maskInputFn,d=t.dataURLOptions,l=void 0===d?{}:d,u=t.inlineImages,p=t.recordCanvas,h=t.keepIframeSrcFn,g=t.newlyAddedElement,m=void 0!==g&&g,f=t.rootId,I=_isBlockedElement(e,o,n),y=getValidTagName(e),S={},C=e.attributes.length,v=0;v<C;v++){var b=e.attributes[v];S[b.name]=transformAttribute(r,y,b.name,b.value)}if("link"===y&&i){var E=Array.from(r.styleSheets).find((function(t){return t.href===e.href})),A=null;E&&(A=getCssRulesString(E)),A&&(delete S.rel,delete S.href,S._cssText=absoluteToStylesheet(A,E.href))}"style"===y&&e.sheet&&!(e.innerText||e.textContent||"").trim().length&&((A=getCssRulesString(e.sheet))&&(S._cssText=absoluteToStylesheet(A,getHref())));if("input"===y||"textarea"===y||"select"===y){var T=e.value,R=e.checked;"radio"!==S.type&&"checkbox"!==S.type&&"submit"!==S.type&&"button"!==S.type&&T?S.value=maskInputValue({type:S.type,tagName:y,value:T,maskInputOptions:s,maskInputFn:c}):R&&(S.checked=R)}if("option"===y&&(e.selected&&!s.select?S.selected=!0:delete S.selected),"canvas"===y&&p)if("2d"===e.__context)is2DCanvasBlank(e)||(S.rr_dataURL=e.toDataURL(l.type,l.quality));else if(!("__context"in e)){var w=e.toDataURL(l.type,l.quality),k=document.createElement("canvas");k.width=e.width,k.height=e.height,w!==k.toDataURL(l.type,l.quality)&&(S.rr_dataURL=w)}if("img"===y&&u){canvasService||(canvasService=r.createElement("canvas"),canvasCtx=canvasService.getContext("2d"));var B=e,M=B.crossOrigin;B.crossOrigin="anonymous";var N=function(){try{canvasService.width=B.naturalWidth,canvasService.height=B.naturalHeight,canvasCtx.drawImage(B,0,0),S.rr_dataURL=canvasService.toDataURL(l.type,l.quality)}catch(e){console.warn("Cannot inline img src=".concat(B.currentSrc,"! Error: ").concat(e))}M?S.crossOrigin=M:B.removeAttribute("crossorigin")};B.complete&&0!==B.naturalWidth?N():B.onload=N}if("audio"!==y&&"video"!==y||(S.rr_mediaState=e.paused?"paused":"played",S.rr_mediaCurrentTime=e.currentTime),m||(e.scrollLeft&&(S.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(S.rr_scrollTop=e.scrollTop)),I){var O=e.getBoundingClientRect(),D=O.width,_=O.height;S={class:S.class,rr_width:"".concat(D,"px"),rr_height:"".concat(_,"px")}}return"iframe"!==y||h(S.src)||(e.contentDocument||(S.rr_src=S.src),delete S.src),{type:NodeType$2.Element,tagName:y,attributes:S,childNodes:[],isSVG:isSVGElement(e)||void 0,needBlock:I,rootId:f}}function lowerIfExists(e){return void 0===e?"":e.toLowerCase()}function slimDOMExcluded(e,t){if(t.comment&&e.type===NodeType$2.Comment)return!0;if(e.type===NodeType$2.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&"preload"===e.attributes.rel&&"script"===e.attributes.as||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"==typeof e.attributes.href&&e.attributes.href.endsWith(".js")))return!0;if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(lowerIfExists(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===lowerIfExists(e.attributes.name)||"icon"===lowerIfExists(e.attributes.rel)||"apple-touch-icon"===lowerIfExists(e.attributes.rel)||"shortcut icon"===lowerIfExists(e.attributes.rel))))return!0;if("meta"===e.tagName){if(t.headMetaDescKeywords&&lowerIfExists(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(lowerIfExists(e.attributes.property).match(/^(og|twitter|fb):/)||lowerIfExists(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===lowerIfExists(e.attributes.name)))return!0;if(t.headMetaRobots&&("robots"===lowerIfExists(e.attributes.name)||"googlebot"===lowerIfExists(e.attributes.name)||"bingbot"===lowerIfExists(e.attributes.name)))return!0;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return!0;if(t.headMetaAuthorship&&("author"===lowerIfExists(e.attributes.name)||"generator"===lowerIfExists(e.attributes.name)||"framework"===lowerIfExists(e.attributes.name)||"publisher"===lowerIfExists(e.attributes.name)||"progid"===lowerIfExists(e.attributes.name)||lowerIfExists(e.attributes.property).match(/^article:/)||lowerIfExists(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&("google-site-verification"===lowerIfExists(e.attributes.name)||"yandex-verification"===lowerIfExists(e.attributes.name)||"csrf-token"===lowerIfExists(e.attributes.name)||"p:domain_verify"===lowerIfExists(e.attributes.name)||"verify-v1"===lowerIfExists(e.attributes.name)||"verification"===lowerIfExists(e.attributes.name)||"shopify-checkout-api-token"===lowerIfExists(e.attributes.name)))return!0}}return!1}function serializeNodeWithId(e,t){var r,o=t.doc,n=t.mirror,i=t.blockClass,a=t.blockSelector,s=t.maskTextClass,c=t.maskTextSelector,d=t.skipChild,l=void 0!==d&&d,u=t.inlineStylesheet,p=void 0===u||u,h=t.maskInputOptions,g=void 0===h?{}:h,m=t.maskTextFn,f=t.maskInputFn,I=t.slimDOMOptions,y=t.dataURLOptions,S=void 0===y?{}:y,C=t.inlineImages,v=void 0!==C&&C,b=t.recordCanvas,E=void 0!==b&&b,A=t.onSerialize,T=t.onIframeLoad,R=t.iframeLoadTimeout,w=void 0===R?5e3:R,k=t.onStylesheetLoad,B=t.stylesheetLoadTimeout,M=void 0===B?5e3:B,N=t.keepIframeSrcFn,O=void 0===N?function(){return!1}:N,D=t.newlyAddedElement,_=void 0!==D&&D,P=t.preserveWhiteSpace,L=void 0===P||P,F=serializeNode(e,{doc:o,mirror:n,blockClass:i,blockSelector:a,maskTextClass:s,maskTextSelector:c,inlineStylesheet:p,maskInputOptions:g,maskTextFn:m,maskInputFn:f,dataURLOptions:S,inlineImages:v,recordCanvas:E,keepIframeSrcFn:O,newlyAddedElement:_});if(!F)return console.warn(e,"not serialized"),null;r=n.hasNode(e)?n.getId(e):slimDOMExcluded(F,I)||!L&&F.type===NodeType$2.Text&&!F.isStyle&&!F.textContent.replace(/^\s+|\s+$/gm,"").length?IGNORED_NODE:genId();var x=Object.assign(F,{id:r});if(n.add(e,x),r===IGNORED_NODE)return null;A&&A(e);var W=!l;if(x.type===NodeType$2.Element){W=W&&!x.needBlock,delete x.needBlock;var U=e.shadowRoot;U&&isNativeShadowDom(U)&&(x.isShadowHost=!0)}if((x.type===NodeType$2.Document||x.type===NodeType$2.Element)&&W){I.headWhitespace&&x.type===NodeType$2.Element&&"head"===x.tagName&&(L=!1);for(var H={doc:o,mirror:n,blockClass:i,blockSelector:a,maskTextClass:s,maskTextSelector:c,skipChild:l,inlineStylesheet:p,maskInputOptions:g,maskTextFn:m,maskInputFn:f,slimDOMOptions:I,dataURLOptions:S,inlineImages:v,recordCanvas:E,preserveWhiteSpace:L,onSerialize:A,onIframeLoad:T,iframeLoadTimeout:w,onStylesheetLoad:k,stylesheetLoadTimeout:M,keepIframeSrcFn:O},V=0,G=Array.from(e.childNodes);V<G.length;V++){(z=serializeNodeWithId(G[V],H))&&x.childNodes.push(z)}if(isElement(e)&&e.shadowRoot)for(var Z=0,q=Array.from(e.shadowRoot.childNodes);Z<q.length;Z++){var z;(z=serializeNodeWithId(q[Z],H))&&(isNativeShadowDom(e.shadowRoot)&&(z.isShadow=!0),x.childNodes.push(z))}}return e.parentNode&&isShadowRoot(e.parentNode)&&isNativeShadowDom(e.parentNode)&&(x.isShadow=!0),x.type===NodeType$2.Element&&"iframe"===x.tagName&&onceIframeLoaded(e,(function(){var t=e.contentDocument;if(t&&T){var r=serializeNodeWithId(t,{doc:t,mirror:n,blockClass:i,blockSelector:a,maskTextClass:s,maskTextSelector:c,skipChild:!1,inlineStylesheet:p,maskInputOptions:g,maskTextFn:m,maskInputFn:f,slimDOMOptions:I,dataURLOptions:S,inlineImages:v,recordCanvas:E,preserveWhiteSpace:L,onSerialize:A,onIframeLoad:T,iframeLoadTimeout:w,onStylesheetLoad:k,stylesheetLoadTimeout:M,keepIframeSrcFn:O});r&&T(e,r)}}),w),x.type===NodeType$2.Element&&"link"===x.tagName&&"stylesheet"===x.attributes.rel&&onceStylesheetLoaded(e,(function(){if(k){var t=serializeNodeWithId(e,{doc:o,mirror:n,blockClass:i,blockSelector:a,maskTextClass:s,maskTextSelector:c,skipChild:!1,inlineStylesheet:p,maskInputOptions:g,maskTextFn:m,maskInputFn:f,slimDOMOptions:I,dataURLOptions:S,inlineImages:v,recordCanvas:E,preserveWhiteSpace:L,onSerialize:A,onIframeLoad:T,iframeLoadTimeout:w,onStylesheetLoad:k,stylesheetLoadTimeout:M,keepIframeSrcFn:O});t&&k(e,t)}}),M),x}function snapshot(e,t){var r=t||{},o=r.mirror,n=void 0===o?new Mirror:o,i=r.blockClass,a=void 0===i?"rr-block":i,s=r.blockSelector,c=void 0===s?null:s,d=r.maskTextClass,l=void 0===d?"rr-mask":d,u=r.maskTextSelector,p=void 0===u?null:u,h=r.inlineStylesheet,g=void 0===h||h,m=r.inlineImages,f=void 0!==m&&m,I=r.recordCanvas,y=void 0!==I&&I,S=r.maskAllInputs,C=void 0!==S&&S,v=r.maskTextFn,b=r.maskInputFn,E=r.slimDOM,A=void 0!==E&&E,T=r.dataURLOptions,R=r.preserveWhiteSpace,w=r.onSerialize,k=r.onIframeLoad,B=r.iframeLoadTimeout,M=r.onStylesheetLoad,N=r.stylesheetLoadTimeout,O=r.keepIframeSrcFn;return serializeNodeWithId(e,{doc:e,mirror:n,blockClass:a,blockSelector:c,maskTextClass:l,maskTextSelector:p,skipChild:!1,inlineStylesheet:g,maskInputOptions:!0===C?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===C?{password:!0}:C,maskTextFn:v,maskInputFn:b,slimDOMOptions:!0===A||"all"===A?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===A,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===A?{}:A,dataURLOptions:T,inlineImages:f,recordCanvas:y,preserveWhiteSpace:R,onSerialize:w,onIframeLoad:k,iframeLoadTimeout:B,onStylesheetLoad:M,stylesheetLoadTimeout:N,keepIframeSrcFn:void 0===O?function(){return!1}:O,newlyAddedElement:!1})}function on(e,t,r=document){const o={capture:!0,passive:!0};return r.addEventListener(e,t,o),()=>r.removeEventListener(e,t,o)}const DEPARTED_MIRROR_ACCESS_WARNING="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let _mirror={map:{},getId:()=>(console.error(DEPARTED_MIRROR_ACCESS_WARNING),-1),getNode:()=>(console.error(DEPARTED_MIRROR_ACCESS_WARNING),null),removeNodeFromMap(){console.error(DEPARTED_MIRROR_ACCESS_WARNING)},has:()=>(console.error(DEPARTED_MIRROR_ACCESS_WARNING),!1),reset(){console.error(DEPARTED_MIRROR_ACCESS_WARNING)}};function throttle(e,t,r={}){let o=null,n=0;return function(...i){const a=Date.now();n||!1!==r.leading||(n=a);const s=t-(a-n),c=this;s<=0||s>t?(o&&(clearTimeout(o),o=null),n=a,e.apply(c,i)):o||!1===r.trailing||(o=setTimeout((()=>{n=!1===r.leading?0:Date.now(),o=null,e.apply(c,i)}),s))}}function hookSetter(e,t,r,o,n=window){const i=n.Object.getOwnPropertyDescriptor(e,t);return n.Object.defineProperty(e,t,o?r:{set(e){setTimeout((()=>{r.set.call(this,e)}),0),i&&i.set&&i.set.call(this,e)}}),()=>hookSetter(e,t,i||{},!0)}function patch(e,t,r){try{if(!(t in e))return()=>{};const o=e[t],n=r(o);return"function"==typeof n&&(n.prototype=n.prototype||{},Object.defineProperties(n,{__rrweb_original__:{enumerable:!1,value:o}})),e[t]=n,()=>{e[t]=o}}catch(e){return()=>{}}}function getWindowHeight(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function getWindowWidth(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function isBlocked(e,t,r,o){if(!e)return!1;const n=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(!n)return!1;if("string"==typeof t){if(n.classList.contains(t))return!0;if(o&&null!==n.closest("."+t))return!0}else if(classMatchesRegex(n,t,o))return!0;if(r){if(e.matches(r))return!0;if(o&&null!==n.closest(r))return!0}return!1}function isSerialized(e,t){return-1!==t.getId(e)}function isIgnored(e,t){return t.getId(e)===IGNORED_NODE}function isAncestorRemoved(e,t){if(isShadowRoot(e))return!1;const r=t.getId(e);return!t.has(r)||(!e.parentNode||e.parentNode.nodeType!==e.DOCUMENT_NODE)&&(!e.parentNode||isAncestorRemoved(e.parentNode,t))}function isTouchEvent(e){return Boolean(e.changedTouches)}function polyfill(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let t=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do{if(this===t)return!0}while(t=t&&t.parentNode);return!1})}function isSerializedIframe(e,t){return Boolean("IFRAME"===e.nodeName&&t.getMeta(e))}function isSerializedStylesheet(e,t){return Boolean("LINK"===e.nodeName&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&"stylesheet"===e.getAttribute("rel")&&t.getMeta(e))}function hasShadowRoot(e){return Boolean(null==e?void 0:e.shadowRoot)}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(_mirror=new Proxy(_mirror,{get:(e,t,r)=>("map"===t&&console.error(DEPARTED_MIRROR_ACCESS_WARNING),Reflect.get(e,t,r))}));class StyleSheetMirror{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){var t;return null!==(t=this.styleIDMap.get(e))&&void 0!==t?t:-1}has(e){return this.styleIDMap.has(e)}add(e,t){if(this.has(e))return this.getId(e);let r;return r=void 0===t?this.id++:t,this.styleIDMap.set(e,r),this.idStyleMap.set(r,e),r}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}var EventType=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(EventType||{}),IncrementalSource=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e))(IncrementalSource||{}),MouseInteractions=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(MouseInteractions||{}),CanvasContext=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(CanvasContext||{});function isNodeInLinkedList(e){return"__ln"in e}class DoubleLinkedList{constructor(){this.length=0,this.head=null}get(e){if(e>=this.length)throw new Error("Position outside of list range");let t=this.head;for(let r=0;r<e;r++)t=(null==t?void 0:t.next)||null;return t}addNode(e){const t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&isNodeInLinkedList(e.previousSibling)){const r=e.previousSibling.__ln.next;t.next=r,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,r&&(r.previous=t)}else if(e.nextSibling&&isNodeInLinkedList(e.nextSibling)&&e.nextSibling.__ln.previous){const r=e.nextSibling.__ln.previous;t.previous=r,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,r&&(r.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;this.length++}removeNode(e){const t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next&&(t.next.previous=t.previous)):(this.head=t.next,this.head&&(this.head.previous=null)),e.__ln&&delete e.__ln,this.length--)}}const moveKey=(e,t)=>`${e}@${t}`;class MutationBuffer{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const e=[],t=new DoubleLinkedList,r=e=>{let t=e,r=IGNORED_NODE;for(;r===IGNORED_NODE;)t=t&&t.nextSibling,r=t&&this.mirror.getId(t);return r},o=o=>{var n,i,a,s;let c=null;(null===(i=null===(n=o.getRootNode)||void 0===n?void 0:n.call(o))||void 0===i?void 0:i.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&o.getRootNode().host&&(c=o.getRootNode().host);let d=c;for(;(null===(s=null===(a=null==d?void 0:d.getRootNode)||void 0===a?void 0:a.call(d))||void 0===s?void 0:s.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&d.getRootNode().host;)d=d.getRootNode().host;const l=!(this.doc.contains(o)||d&&this.doc.contains(d));if(!o.parentNode||l)return;const u=isShadowRoot(o.parentNode)?this.mirror.getId(c):this.mirror.getId(o.parentNode),p=r(o);if(-1===u||-1===p)return t.addNode(o);const h=serializeNodeWithId(o,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:e=>{isSerializedIframe(e,this.mirror)&&this.iframeManager.addIframe(e),isSerializedStylesheet(e,this.mirror)&&this.stylesheetManager.trackLinkElement(e),hasShadowRoot(o)&&this.shadowDomManager.addShadowRoot(o.shadowRoot,this.doc)},onIframeLoad:(e,t)=>{this.iframeManager.attachIframe(e,t),this.shadowDomManager.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{this.stylesheetManager.attachLinkElement(e,t)}});h&&e.push({parentId:u,nextId:p,node:h})};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const e of Array.from(this.movedSet.values()))isParentRemoved(this.removes,e,this.mirror)&&!this.movedSet.has(e.parentNode)||o(e);for(const e of Array.from(this.addedSet.values()))isAncestorInSet(this.droppedSet,e)||isParentRemoved(this.removes,e,this.mirror)?isAncestorInSet(this.movedSet,e)?o(e):this.droppedSet.add(e):o(e);let n=null;for(;t.length;){let e=null;if(n){const t=this.mirror.getId(n.value.parentNode),o=r(n.value);-1!==t&&-1!==o&&(e=n)}if(!e)for(let o=t.length-1;o>=0;o--){const n=t.get(o);if(n){const t=this.mirror.getId(n.value.parentNode);if(-1===r(n.value))continue;if(-1!==t){e=n;break}{const t=n.value;if(t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const r=t.parentNode.host;if(-1!==this.mirror.getId(r)){e=n;break}}}}}if(!e){for(;t.head;)t.removeNode(t.head.value);break}n=e.previous,t.removeNode(e.value),o(e.value)}const i={texts:this.texts.map((e=>({id:this.mirror.getId(e.node),value:e.value}))).filter((e=>this.mirror.has(e.id))),attributes:this.attributes.map((e=>({id:this.mirror.getId(e.node),attributes:e.attributes}))).filter((e=>this.mirror.has(e.id))),removes:this.removes,adds:e};(i.texts.length||i.attributes.length||i.removes.length||i.adds.length)&&(this.texts=[],this.attributes=[],this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(i))},this.processMutation=e=>{if(!isIgnored(e.target,this.mirror))switch(e.type){case"characterData":{const t=e.target.textContent;isBlocked(e.target,this.blockClass,this.blockSelector,!1)||t===e.oldValue||this.texts.push({value:needMaskingText(e.target,this.maskTextClass,this.maskTextSelector)&&t?this.maskTextFn?this.maskTextFn(t):t.replace(/[\S]/g,"*"):t,node:e.target});break}case"attributes":{const t=e.target;let r=e.target.getAttribute(e.attributeName);if("value"===e.attributeName&&(r=maskInputValue({maskInputOptions:this.maskInputOptions,tagName:e.target.tagName,type:e.target.getAttribute("type"),value:r,maskInputFn:this.maskInputFn})),isBlocked(e.target,this.blockClass,this.blockSelector,!1)||r===e.oldValue)return;let o=this.attributes.find((t=>t.node===e.target));if("IFRAME"===t.tagName&&"src"===e.attributeName&&!this.keepIframeSrcFn(r)){if(t.contentDocument)return;e.attributeName="rr_src"}if(o||(o={node:e.target,attributes:{}},this.attributes.push(o)),"style"===e.attributeName){const r=this.doc.createElement("span");e.oldValue&&r.setAttribute("style",e.oldValue),void 0!==o.attributes.style&&null!==o.attributes.style||(o.attributes.style={});const n=o.attributes.style;for(const e of Array.from(t.style)){const o=t.style.getPropertyValue(e),i=t.style.getPropertyPriority(e);o===r.style.getPropertyValue(e)&&i===r.style.getPropertyPriority(e)||(n[e]=""===i?o:[o,i])}for(const e of Array.from(r.style))""===t.style.getPropertyValue(e)&&(n[e]=!1)}else o.attributes[e.attributeName]=transformAttribute(this.doc,t.tagName,e.attributeName,r);break}case"childList":if(isBlocked(e.target,this.blockClass,this.blockSelector,!0))return;e.addedNodes.forEach((t=>this.genAdds(t,e.target))),e.removedNodes.forEach((t=>{const r=this.mirror.getId(t),o=isShadowRoot(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);isBlocked(e.target,this.blockClass,this.blockSelector,!1)||isIgnored(t,this.mirror)||!isSerialized(t,this.mirror)||(this.addedSet.has(t)?(deepDelete(this.addedSet,t),this.droppedSet.add(t)):this.addedSet.has(e.target)&&-1===r||isAncestorRemoved(e.target,this.mirror)||(this.movedSet.has(t)&&this.movedMap[moveKey(r,o)]?deepDelete(this.movedSet,t):this.removes.push({parentId:o,id:r,isShadow:!(!isShadowRoot(e.target)||!isNativeShadowDom(e.target))||void 0})),this.mapRemoves.push(t))}))}},this.genAdds=(e,t)=>{if(this.mirror.hasNode(e)){if(isIgnored(e,this.mirror))return;this.movedSet.add(e);let r=null;t&&this.mirror.hasNode(t)&&(r=this.mirror.getId(t)),r&&-1!==r&&(this.movedMap[moveKey(this.mirror.getId(e),r)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);isBlocked(e,this.blockClass,this.blockSelector,!1)||e.childNodes.forEach((e=>this.genAdds(e)))}}init(e){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager"].forEach((t=>{this[t]=e[t]}))}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function deepDelete(e,t){e.delete(t),t.childNodes.forEach((t=>deepDelete(e,t)))}function isParentRemoved(e,t,r){return 0!==e.length&&_isParentRemoved(e,t,r)}function _isParentRemoved(e,t,r){const{parentNode:o}=t;if(!o)return!1;const n=r.getId(o);return!!e.some((e=>e.id===n))||_isParentRemoved(e,o,r)}function isAncestorInSet(e,t){return 0!==e.size&&_isAncestorInSet(e,t)}function _isAncestorInSet(e,t){const{parentNode:r}=t;return!!r&&(!!e.has(r)||_isAncestorInSet(e,r))}const mutationBuffers=[],isCSSGroupingRuleSupported="undefined"!=typeof CSSGroupingRule,isCSSMediaRuleSupported="undefined"!=typeof CSSMediaRule,isCSSSupportsRuleSupported="undefined"!=typeof CSSSupportsRule,isCSSConditionRuleSupported="undefined"!=typeof CSSConditionRule;function getEventTarget(e){try{if("composedPath"in e){const t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0];return e.target}catch(t){return e.target}}function initMutationObserver(e,t){var r,o;const n=new MutationBuffer;mutationBuffers.push(n),n.init(e);let i=window.MutationObserver||window.__rrMutationObserver;const a=null===(o=null===(r=null===window||void 0===window?void 0:window.Zone)||void 0===r?void 0:r.__symbol__)||void 0===o?void 0:o.call(r,"MutationObserver");a&&window[a]&&(i=window[a]);const s=new i(n.processMutations.bind(n));return s.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),s}function initMoveObserver({mousemoveCb:e,sampling:t,doc:r,mirror:o}){if(!1===t.mousemove)return()=>{};const n="number"==typeof t.mousemove?t.mousemove:50,i="number"==typeof t.mousemoveCallback?t.mousemoveCallback:500;let a,s=[];const c=throttle((t=>{const r=Date.now()-a;e(s.map((e=>(e.timeOffset-=r,e))),t),s=[],a=null}),i),d=throttle((e=>{const t=getEventTarget(e),{clientX:r,clientY:n}=isTouchEvent(e)?e.changedTouches[0]:e;a||(a=Date.now()),s.push({x:r,y:n,id:o.getId(t),timeOffset:Date.now()-a}),c("undefined"!=typeof DragEvent&&e instanceof DragEvent?IncrementalSource.Drag:e instanceof MouseEvent?IncrementalSource.MouseMove:IncrementalSource.TouchMove)}),n,{trailing:!1}),l=[on("mousemove",d,r),on("touchmove",d,r),on("drag",d,r)];return()=>{l.forEach((e=>e()))}}function initMouseInteractionObserver({mouseInteractionCb:e,doc:t,mirror:r,blockClass:o,blockSelector:n,sampling:i}){if(!1===i.mouseInteraction)return()=>{};const a=!0===i.mouseInteraction||void 0===i.mouseInteraction?{}:i.mouseInteraction,s=[];return Object.keys(MouseInteractions).filter((e=>Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==a[e])).forEach((i=>{const a=i.toLowerCase(),c=(t=>i=>{const a=getEventTarget(i);if(isBlocked(a,o,n,!0))return;const s=isTouchEvent(i)?i.changedTouches[0]:i;if(!s)return;const c=r.getId(a),{clientX:d,clientY:l}=s;e({type:MouseInteractions[t],id:c,x:d,y:l})})(i);s.push(on(a,c,t))})),()=>{s.forEach((e=>e()))}}function initScrollObserver({scrollCb:e,doc:t,mirror:r,blockClass:o,blockSelector:n,sampling:i}){return on("scroll",throttle((i=>{const a=getEventTarget(i);if(!a||isBlocked(a,o,n,!0))return;const s=r.getId(a);if(a===t){const r=t.scrollingElement||t.documentElement;e({id:s,x:r.scrollLeft,y:r.scrollTop})}else e({id:s,x:a.scrollLeft,y:a.scrollTop})}),i.scroll||100),t)}function initViewportResizeObserver({viewportResizeCb:e}){let t=-1,r=-1;return on("resize",throttle((()=>{const o=getWindowHeight(),n=getWindowWidth();t===o&&r===n||(e({width:Number(n),height:Number(o)}),t=o,r=n)}),200),window)}function wrapEventWithUserTriggeredFlag(e,t){const r=Object.assign({},e);return t||delete r.userTriggered,r}const INPUT_TAGS=["INPUT","TEXTAREA","SELECT"],lastInputValueMap=new WeakMap;function initInputObserver({inputCb:e,doc:t,mirror:r,blockClass:o,blockSelector:n,ignoreClass:i,maskInputOptions:a,maskInputFn:s,sampling:c,userTriggeredOnInput:d}){function l(e){let r=getEventTarget(e);const c=e.isTrusted;if(r&&"OPTION"===r.tagName&&(r=r.parentElement),!r||!r.tagName||INPUT_TAGS.indexOf(r.tagName)<0||isBlocked(r,o,n,!0))return;const l=r.type;if(r.classList.contains(i))return;let p=r.value,h=!1;"radio"===l||"checkbox"===l?h=r.checked:(a[r.tagName.toLowerCase()]||a[l])&&(p=maskInputValue({maskInputOptions:a,tagName:r.tagName,type:l,value:p,maskInputFn:s})),u(r,wrapEventWithUserTriggeredFlag({text:p,isChecked:h,userTriggered:c},d));const g=r.name;"radio"===l&&g&&h&&t.querySelectorAll(`input[type="radio"][name="${g}"]`).forEach((e=>{e!==r&&u(e,wrapEventWithUserTriggeredFlag({text:e.value,isChecked:!h,userTriggered:!1},d))}))}function u(t,o){const n=lastInputValueMap.get(t);if(!n||n.text!==o.text||n.isChecked!==o.isChecked){lastInputValueMap.set(t,o);const n=r.getId(t);e(Object.assign(Object.assign({},o),{id:n}))}}const p=("last"===c.input?["change"]:["input","change"]).map((e=>on(e,l,t))),h=t.defaultView;if(!h)return()=>{p.forEach((e=>e()))};const g=h.Object.getOwnPropertyDescriptor(h.HTMLInputElement.prototype,"value"),m=[[h.HTMLInputElement.prototype,"value"],[h.HTMLInputElement.prototype,"checked"],[h.HTMLSelectElement.prototype,"value"],[h.HTMLTextAreaElement.prototype,"value"],[h.HTMLSelectElement.prototype,"selectedIndex"],[h.HTMLOptionElement.prototype,"selected"]];return g&&g.set&&p.push(...m.map((e=>hookSetter(e[0],e[1],{set(){l({target:this})}},!1,h)))),()=>{p.forEach((e=>e()))}}function getNestedCSSRulePositions(e){return function(e,t){if(isCSSGroupingRuleSupported&&e.parentRule instanceof CSSGroupingRule||isCSSMediaRuleSupported&&e.parentRule instanceof CSSMediaRule||isCSSSupportsRuleSupported&&e.parentRule instanceof CSSSupportsRule||isCSSConditionRuleSupported&&e.parentRule instanceof CSSConditionRule){const r=Array.from(e.parentRule.cssRules).indexOf(e);t.unshift(r)}else if(e.parentStyleSheet){const r=Array.from(e.parentStyleSheet.cssRules).indexOf(e);t.unshift(r)}return t}(e,[])}function getIdAndStyleId(e,t,r){let o,n;return e?(e.ownerNode?o=t.getId(e.ownerNode):n=r.getId(e),{styleId:n,id:o}):{}}function initStyleSheetObserver({styleSheetRuleCb:e,mirror:t,stylesheetManager:r},{win:o}){const n=o.CSSStyleSheet.prototype.insertRule;o.CSSStyleSheet.prototype.insertRule=function(o,i){const{id:a,styleId:s}=getIdAndStyleId(this,t,r.styleMirror);return(a&&-1!==a||s&&-1!==s)&&e({id:a,styleId:s,adds:[{rule:o,index:i}]}),n.apply(this,[o,i])};const i=o.CSSStyleSheet.prototype.deleteRule;let a,s;o.CSSStyleSheet.prototype.deleteRule=function(o){const{id:n,styleId:a}=getIdAndStyleId(this,t,r.styleMirror);return(n&&-1!==n||a&&-1!==a)&&e({id:n,styleId:a,removes:[{index:o}]}),i.apply(this,[o])},o.CSSStyleSheet.prototype.replace&&(a=o.CSSStyleSheet.prototype.replace,o.CSSStyleSheet.prototype.replace=function(o){const{id:n,styleId:i}=getIdAndStyleId(this,t,r.styleMirror);return(n&&-1!==n||i&&-1!==i)&&e({id:n,styleId:i,replace:o}),a.apply(this,[o])}),o.CSSStyleSheet.prototype.replaceSync&&(s=o.CSSStyleSheet.prototype.replaceSync,o.CSSStyleSheet.prototype.replaceSync=function(o){const{id:n,styleId:i}=getIdAndStyleId(this,t,r.styleMirror);return(n&&-1!==n||i&&-1!==i)&&e({id:n,styleId:i,replaceSync:o}),s.apply(this,[o])});const c={};isCSSGroupingRuleSupported?c.CSSGroupingRule=o.CSSGroupingRule:(isCSSMediaRuleSupported&&(c.CSSMediaRule=o.CSSMediaRule),isCSSConditionRuleSupported&&(c.CSSConditionRule=o.CSSConditionRule),isCSSSupportsRuleSupported&&(c.CSSSupportsRule=o.CSSSupportsRule));const d={};return Object.entries(c).forEach((([o,n])=>{d[o]={insertRule:n.prototype.insertRule,deleteRule:n.prototype.deleteRule},n.prototype.insertRule=function(n,i){const{id:a,styleId:s}=getIdAndStyleId(this.parentStyleSheet,t,r.styleMirror);return(a&&-1!==a||s&&-1!==s)&&e({id:a,styleId:s,adds:[{rule:n,index:[...getNestedCSSRulePositions(this),i||0]}]}),d[o].insertRule.apply(this,[n,i])},n.prototype.deleteRule=function(n){const{id:i,styleId:a}=getIdAndStyleId(this.parentStyleSheet,t,r.styleMirror);return(i&&-1!==i||a&&-1!==a)&&e({id:i,styleId:a,removes:[{index:[...getNestedCSSRulePositions(this),n]}]}),d[o].deleteRule.apply(this,[n])}})),()=>{o.CSSStyleSheet.prototype.insertRule=n,o.CSSStyleSheet.prototype.deleteRule=i,a&&(o.CSSStyleSheet.prototype.replace=a),s&&(o.CSSStyleSheet.prototype.replaceSync=s),Object.entries(c).forEach((([e,t])=>{t.prototype.insertRule=d[e].insertRule,t.prototype.deleteRule=d[e].deleteRule}))}}function initAdoptedStyleSheetObserver({mirror:e,stylesheetManager:t},r){var o,n,i;let a=null;a="#document"===r.nodeName?e.getId(r):e.getId(r.host);const s="#document"===r.nodeName?null===(o=r.defaultView)||void 0===o?void 0:o.Document:null===(i=null===(n=r.ownerDocument)||void 0===n?void 0:n.defaultView)||void 0===i?void 0:i.ShadowRoot,c=Object.getOwnPropertyDescriptor(null==s?void 0:s.prototype,"adoptedStyleSheets");return null!==a&&-1!==a&&s&&c?(Object.defineProperty(r,"adoptedStyleSheets",{configurable:c.configurable,enumerable:c.enumerable,get(){var e;return null===(e=c.get)||void 0===e?void 0:e.call(this)},set(e){var r;const o=null===(r=c.set)||void 0===r?void 0:r.call(this,e);if(null!==a&&-1!==a)try{t.adoptStyleSheets(e,a)}catch(e){}return o}}),()=>{Object.defineProperty(r,"adoptedStyleSheets",{configurable:c.configurable,enumerable:c.enumerable,get:c.get,set:c.set})}):()=>{}}function initStyleDeclarationObserver({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:r,stylesheetManager:o},{win:n}){const i=n.CSSStyleDeclaration.prototype.setProperty;n.CSSStyleDeclaration.prototype.setProperty=function(n,a,s){var c;if(r.has(n))return i.apply(this,[n,a,s]);const{id:d,styleId:l}=getIdAndStyleId(null===(c=this.parentRule)||void 0===c?void 0:c.parentStyleSheet,t,o.styleMirror);return(d&&-1!==d||l&&-1!==l)&&e({id:d,styleId:l,set:{property:n,value:a,priority:s},index:getNestedCSSRulePositions(this.parentRule)}),i.apply(this,[n,a,s])};const a=n.CSSStyleDeclaration.prototype.removeProperty;return n.CSSStyleDeclaration.prototype.removeProperty=function(n){var i;if(r.has(n))return a.apply(this,[n]);const{id:s,styleId:c}=getIdAndStyleId(null===(i=this.parentRule)||void 0===i?void 0:i.parentStyleSheet,t,o.styleMirror);return(s&&-1!==s||c&&-1!==c)&&e({id:s,styleId:c,remove:{property:n},index:getNestedCSSRulePositions(this.parentRule)}),a.apply(this,[n])},()=>{n.CSSStyleDeclaration.prototype.setProperty=i,n.CSSStyleDeclaration.prototype.removeProperty=a}}function initMediaInteractionObserver({mediaInteractionCb:e,blockClass:t,blockSelector:r,mirror:o,sampling:n}){const i=i=>throttle((n=>{const a=getEventTarget(n);if(!a||isBlocked(a,t,r,!0))return;const{currentTime:s,volume:c,muted:d,playbackRate:l}=a;e({type:i,id:o.getId(a),currentTime:s,volume:c,muted:d,playbackRate:l})}),n.media||500),a=[on("play",i(0)),on("pause",i(1)),on("seeked",i(2)),on("volumechange",i(3)),on("ratechange",i(4))];return()=>{a.forEach((e=>e()))}}function initFontObserver({fontCb:e,doc:t}){const r=t.defaultView;if(!r)return()=>{};const o=[],n=new WeakMap,i=r.FontFace;r.FontFace=function(e,t,r){const o=new i(e,t,r);return n.set(o,{family:e,buffer:"string"!=typeof t,descriptors:r,fontSource:"string"==typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),o};const a=patch(t.fonts,"add",(function(t){return function(r){return setTimeout((()=>{const t=n.get(r);t&&(e(t),n.delete(r))}),0),t.apply(this,[r])}}));return o.push((()=>{r.FontFace=i})),o.push(a),()=>{o.forEach((e=>e()))}}function initSelectionObserver(e){const{doc:t,mirror:r,blockClass:o,blockSelector:n,selectionCb:i}=e;let a=!0;const s=()=>{const e=t.getSelection();if(!e||a&&(null==e?void 0:e.isCollapsed))return;a=e.isCollapsed||!1;const s=[],c=e.rangeCount||0;for(let t=0;t<c;t++){const i=e.getRangeAt(t),{startContainer:a,startOffset:c,endContainer:d,endOffset:l}=i;isBlocked(a,o,n,!0)||isBlocked(d,o,n,!0)||s.push({start:r.getId(a),startOffset:c,end:r.getId(d),endOffset:l})}i({ranges:s})};return s(),on("selectionchange",s)}function mergeHooks(e,t){const{mutationCb:r,mousemoveCb:o,mouseInteractionCb:n,scrollCb:i,viewportResizeCb:a,inputCb:s,mediaInteractionCb:c,styleSheetRuleCb:d,styleDeclarationCb:l,canvasMutationCb:u,fontCb:p,selectionCb:h}=e;e.mutationCb=(...e)=>{t.mutation&&t.mutation(...e),r(...e)},e.mousemoveCb=(...e)=>{t.mousemove&&t.mousemove(...e),o(...e)},e.mouseInteractionCb=(...e)=>{t.mouseInteraction&&t.mouseInteraction(...e),n(...e)},e.scrollCb=(...e)=>{t.scroll&&t.scroll(...e),i(...e)},e.viewportResizeCb=(...e)=>{t.viewportResize&&t.viewportResize(...e),a(...e)},e.inputCb=(...e)=>{t.input&&t.input(...e),s(...e)},e.mediaInteractionCb=(...e)=>{t.mediaInteaction&&t.mediaInteaction(...e),c(...e)},e.styleSheetRuleCb=(...e)=>{t.styleSheetRule&&t.styleSheetRule(...e),d(...e)},e.styleDeclarationCb=(...e)=>{t.styleDeclaration&&t.styleDeclaration(...e),l(...e)},e.canvasMutationCb=(...e)=>{t.canvasMutation&&t.canvasMutation(...e),u(...e)},e.fontCb=(...e)=>{t.font&&t.font(...e),p(...e)},e.selectionCb=(...e)=>{t.selection&&t.selection(...e),h(...e)}}function initObservers(e,t={}){const r=e.doc.defaultView;if(!r)return()=>{};mergeHooks(e,t);const o=initMutationObserver(e,e.doc),n=initMoveObserver(e),i=initMouseInteractionObserver(e),a=initScrollObserver(e),s=initViewportResizeObserver(e),c=initInputObserver(e),d=initMediaInteractionObserver(e),l=initStyleSheetObserver(e,{win:r}),u=initAdoptedStyleSheetObserver(e,e.doc),p=initStyleDeclarationObserver(e,{win:r}),h=e.collectFonts?initFontObserver(e):()=>{},g=initSelectionObserver(e),m=[];for(const t of e.plugins)m.push(t.observer(t.callback,r,t.options));return()=>{mutationBuffers.forEach((e=>e.reset())),o.disconnect(),n(),i(),a(),s(),c(),d(),l(),u(),p(),h(),g(),m.forEach((e=>e()))}}class CrossOriginIframeMirror{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,t,r,o){const n=r||this.getIdToRemoteIdMap(e),i=o||this.getRemoteIdToIdMap(e);let a=n.get(t);return a||(a=this.generateIdFn(),n.set(t,a),i.set(a,t)),a}getIds(e,t){const r=this.getIdToRemoteIdMap(e),o=this.getRemoteIdToIdMap(e);return t.map((t=>this.getId(e,t,r,o)))}getRemoteId(e,t,r){const o=r||this.getRemoteIdToIdMap(e);if("number"!=typeof t)return t;const n=o.get(t);return n||-1}getRemoteIds(e,t){const r=this.getRemoteIdToIdMap(e);return t.map((t=>this.getRemoteId(e,t,r)))}reset(e){if(!e)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let t=this.iframeIdToRemoteIdMap.get(e);return t||(t=new Map,this.iframeIdToRemoteIdMap.set(e,t)),t}getRemoteIdToIdMap(e){let t=this.iframeRemoteIdToIdMap.get(e);return t||(t=new Map,this.iframeRemoteIdToIdMap.set(e,t)),t}}class IframeManager{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new CrossOriginIframeMirror(genId),this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new CrossOriginIframeMirror(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,t){var r;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),null===(r=this.loadListener)||void 0===r||r.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){if("rrweb"===e.data.type){if(!e.source)return;const t=this.crossOriginIframeMap.get(e.source);if(!t)return;const r=this.transformCrossOriginEvent(t,e.data.event);r&&this.wrappedEmit(r,e.data.isCheckout)}}transformCrossOriginEvent(e,t){var r;switch(t.type){case EventType.FullSnapshot:return this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(t.data.node,e),{timestamp:t.timestamp,type:EventType.IncrementalSnapshot,data:{source:IncrementalSource.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:t.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}};case EventType.Meta:case EventType.Load:case EventType.DomContentLoaded:return!1;case EventType.Plugin:return t;case EventType.Custom:return this.replaceIds(t.data.payload,e,["id","parentId","previousId","nextId"]),t;case EventType.IncrementalSnapshot:switch(t.data.source){case IncrementalSource.Mutation:return t.data.adds.forEach((t=>{this.replaceIds(t,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(t.node,e)})),t.data.removes.forEach((t=>{this.replaceIds(t,e,["parentId","id"])})),t.data.attributes.forEach((t=>{this.replaceIds(t,e,["id"])})),t.data.texts.forEach((t=>{this.replaceIds(t,e,["id"])})),t;case IncrementalSource.Drag:case IncrementalSource.TouchMove:case IncrementalSource.MouseMove:return t.data.positions.forEach((t=>{this.replaceIds(t,e,["id"])})),t;case IncrementalSource.ViewportResize:return!1;case IncrementalSource.MediaInteraction:case IncrementalSource.MouseInteraction:case IncrementalSource.Scroll:case IncrementalSource.CanvasMutation:case IncrementalSource.Input:return this.replaceIds(t.data,e,["id"]),t;case IncrementalSource.StyleSheetRule:case IncrementalSource.StyleDeclaration:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleId"]),t;case IncrementalSource.Font:return t;case IncrementalSource.Selection:return t.data.ranges.forEach((t=>{this.replaceIds(t,e,["start","end"])})),t;case IncrementalSource.AdoptedStyleSheet:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleIds"]),null===(r=t.data.styles)||void 0===r||r.forEach((t=>{this.replaceStyleIds(t,e,["styleId"])})),t}}}replace(e,t,r,o){for(const n of o)(Array.isArray(t[n])||"number"==typeof t[n])&&(Array.isArray(t[n])?t[n]=e.getIds(r,t[n]):t[n]=e.getId(r,t[n]));return t}replaceIds(e,t,r){return this.replace(this.crossOriginIframeMirror,e,t,r)}replaceStyleIds(e,t,r){return this.replace(this.crossOriginIframeStyleMirror,e,t,r)}replaceIdOnNode(e,t){this.replaceIds(e,t,["id"]),"childNodes"in e&&e.childNodes.forEach((e=>{this.replaceIdOnNode(e,t)}))}}class ShadowDomManager{constructor(e){this.shadowDoms=new WeakSet,this.restorePatches=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror;const t=this;this.restorePatches.push(patch(Element.prototype,"attachShadow",(function(e){return function(r){const o=e.call(this,r);return this.shadowRoot&&t.addShadowRoot(this.shadowRoot,this.ownerDocument),o}})))}addShadowRoot(e,t){isNativeShadowDom(e)&&(this.shadowDoms.has(e)||(this.shadowDoms.add(e),initMutationObserver(Object.assign(Object.assign({},this.bypassOptions),{doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e),initScrollObserver(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror})),setTimeout((()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),initAdoptedStyleSheetObserver({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e)}),0)))}observeAttachShadow(e){if(e.contentWindow){const t=this;this.restorePatches.push(patch(e.contentWindow.HTMLElement.prototype,"attachShadow",(function(r){return function(o){const n=r.call(this,o);return this.shadowRoot&&t.addShadowRoot(this.shadowRoot,e.contentDocument),n}})))}}reset(){this.restorePatches.forEach((e=>e())),this.shadowDoms=new WeakSet}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function __rest(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r}function __awaiter(e,t,r,o){return new(r||(r=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))}for(var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup="undefined"==typeof Uint8Array?[]:new Uint8Array(256),i$1=0;i$1<chars.length;i$1++)lookup[chars.charCodeAt(i$1)]=i$1;var encode=function(e){var t,r=new Uint8Array(e),o=r.length,n="";for(t=0;t<o;t+=3)n+=chars[r[t]>>2],n+=chars[(3&r[t])<<4|r[t+1]>>4],n+=chars[(15&r[t+1])<<2|r[t+2]>>6],n+=chars[63&r[t+2]];return o%3==2?n=n.substring(0,n.length-1)+"=":o%3==1&&(n=n.substring(0,n.length-2)+"=="),n};const canvasVarMap=new Map;function variableListFor(e,t){let r=canvasVarMap.get(e);return r||(r=new Map,canvasVarMap.set(e,r)),r.has(t)||r.set(t,[]),r.get(t)}const saveWebGLVar=(e,t,r)=>{if(!e||!isInstanceOfWebGLObject(e,t)&&"object"!=typeof e)return;const o=variableListFor(r,e.constructor.name);let n=o.indexOf(e);return-1===n&&(n=o.length,o.push(e)),n};function serializeArg(e,t,r){if(e instanceof Array)return e.map((e=>serializeArg(e,t,r)));if(null===e)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray){return{rr_type:e.constructor.name,args:[Object.values(e)]}}if(e instanceof ArrayBuffer){return{rr_type:e.constructor.name,base64:encode(e)}}if(e instanceof DataView){return{rr_type:e.constructor.name,args:[serializeArg(e.buffer,t,r),e.byteOffset,e.byteLength]}}if(e instanceof HTMLImageElement){const t=e.constructor.name,{src:r}=e;return{rr_type:t,src:r}}if(e instanceof HTMLCanvasElement){return{rr_type:"HTMLImageElement",src:e.toDataURL()}}if(e instanceof ImageData){return{rr_type:e.constructor.name,args:[serializeArg(e.data,t,r),e.width,e.height]}}if(isInstanceOfWebGLObject(e,t)||"object"==typeof e){return{rr_type:e.constructor.name,index:saveWebGLVar(e,t,r)}}return e}const serializeArgs=(e,t,r)=>[...e].map((e=>serializeArg(e,t,r))),isInstanceOfWebGLObject=(e,t)=>{const r=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter((e=>"function"==typeof t[e]));return Boolean(r.find((r=>e instanceof t[r])))};function initCanvas2DMutationObserver(e,t,r,o){const n=[],i=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype);for(const a of i)try{if("function"!=typeof t.CanvasRenderingContext2D.prototype[a])continue;const i=patch(t.CanvasRenderingContext2D.prototype,a,(function(n){return function(...i){return isBlocked(this.canvas,r,o,!0)||setTimeout((()=>{const r=serializeArgs([...i],t,this);e(this.canvas,{type:CanvasContext["2D"],property:a,args:r})}),0),n.apply(this,i)}}));n.push(i)}catch(r){const o=hookSetter(t.CanvasRenderingContext2D.prototype,a,{set(t){e(this.canvas,{type:CanvasContext["2D"],property:a,args:[t],setter:!0})}});n.push(o)}return()=>{n.forEach((e=>e()))}}function initCanvasContextObserver(e,t,r){const o=[];try{const n=patch(e.HTMLCanvasElement.prototype,"getContext",(function(e){return function(o,...n){return isBlocked(this,t,r,!0)||"__context"in this||(this.__context=o),e.apply(this,[o,...n])}}));o.push(n)}catch(e){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{o.forEach((e=>e()))}}function patchGLPrototype(e,t,r,o,n,i,a){const s=[],c=Object.getOwnPropertyNames(e);for(const i of c)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(i))try{if("function"!=typeof e[i])continue;const c=patch(e,i,(function(e){return function(...s){const c=e.apply(this,s);if(saveWebGLVar(c,a,this),!isBlocked(this.canvas,o,n,!0)){const e=serializeArgs([...s],a,this),o={type:t,property:i,args:e};r(this.canvas,o)}return c}}));s.push(c)}catch(o){const n=hookSetter(e,i,{set(e){r(this.canvas,{type:t,property:i,args:[e],setter:!0})}});s.push(n)}return s}function initCanvasWebGLMutationObserver(e,t,r,o,n){const i=[];return i.push(...patchGLPrototype(t.WebGLRenderingContext.prototype,CanvasContext.WebGL,e,r,o,n,t)),void 0!==t.WebGL2RenderingContext&&i.push(...patchGLPrototype(t.WebGL2RenderingContext.prototype,CanvasContext.WebGL2,e,r,o,n,t)),()=>{i.forEach((e=>e()))}}var WorkerClass=null;try{var WorkerThreads="undefined"!=typeof module&&"function"==typeof module.require&&module.require("worker_threads")||"function"==typeof __non_webpack_require__&&__non_webpack_require__("worker_threads")||"function"==typeof require&&require("worker_threads");WorkerClass=WorkerThreads.Worker}catch(e){}function decodeBase64$1(e,t){return Buffer.from(e,"base64").toString(t?"utf16":"utf8")}function createBase64WorkerFactory$2(e,t,r){var o=void 0===t?null:t,n=decodeBase64$1(e,void 0!==r&&r),i=n.indexOf("\n",10)+1,a=n.substring(i)+(o?"//# sourceMappingURL="+o:"");return function(e){return new WorkerClass(a,Object.assign({},e,{eval:!0}))}}function decodeBase64(e,t){var r=atob(e);if(t){for(var o=new Uint8Array(r.length),n=0,i=r.length;n<i;++n)o[n]=r.charCodeAt(n);return String.fromCharCode.apply(null,new Uint16Array(o.buffer))}return r}function createURL(e,t,r){var o=void 0===t?null:t,n=decodeBase64(e,void 0!==r&&r),i=n.indexOf("\n",10)+1,a=n.substring(i)+(o?"//# sourceMappingURL="+o:""),s=new Blob([a],{type:"application/javascript"});return URL.createObjectURL(s)}function createBase64WorkerFactory$1(e,t,r){var o;return function(n){return o=o||createURL(e,t,r),new Worker(o,n)}}var kIsNodeJS="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0);function isNodeJS(){return kIsNodeJS}function createBase64WorkerFactory(e,t,r){return isNodeJS()?createBase64WorkerFactory$2(e,t,r):createBase64WorkerFactory$1(e,t,r)}var WorkerFactory=createBase64WorkerFactory("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICAgJ3VzZSBzdHJpY3QnOwoKICAgIC8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KICAgIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLg0KDQogICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55DQogICAgcHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLg0KDQogICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEgNCiAgICBSRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkNCiAgICBBTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsDQogICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NDQogICAgTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1INCiAgICBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SDQogICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4NCiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqLw0KDQogICAgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikgew0KICAgICAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH0NCiAgICAgICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvclsidGhyb3ciXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfQ0KICAgICAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpOw0KICAgICAgICB9KTsNCiAgICB9CgogICAgLyoKICAgICAqIGJhc2U2NC1hcnJheWJ1ZmZlciAxLjAuMSA8aHR0cHM6Ly9naXRodWIuY29tL25pa2xhc3ZoL2Jhc2U2NC1hcnJheWJ1ZmZlcj4KICAgICAqIENvcHlyaWdodCAoYykgMjAyMSBOaWtsYXMgdm9uIEhlcnR6ZW4gPGh0dHBzOi8vaGVydHplbi5jb20+CiAgICAgKiBSZWxlYXNlZCB1bmRlciBNSVQgTGljZW5zZQogICAgICovCiAgICB2YXIgY2hhcnMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyc7CiAgICAvLyBVc2UgYSBsb29rdXAgdGFibGUgdG8gZmluZCB0aGUgaW5kZXguCiAgICB2YXIgbG9va3VwID0gdHlwZW9mIFVpbnQ4QXJyYXkgPT09ICd1bmRlZmluZWQnID8gW10gOiBuZXcgVWludDhBcnJheSgyNTYpOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFycy5sZW5ndGg7IGkrKykgewogICAgICAgIGxvb2t1cFtjaGFycy5jaGFyQ29kZUF0KGkpXSA9IGk7CiAgICB9CiAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKGFycmF5YnVmZmVyKSB7CiAgICAgICAgdmFyIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlidWZmZXIpLCBpLCBsZW4gPSBieXRlcy5sZW5ndGgsIGJhc2U2NCA9ICcnOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gMykgewogICAgICAgICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaV0gPj4gMl07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1soKGJ5dGVzW2ldICYgMykgPDwgNCkgfCAoYnl0ZXNbaSArIDFdID4+IDQpXTsKICAgICAgICAgICAgYmFzZTY0ICs9IGNoYXJzWygoYnl0ZXNbaSArIDFdICYgMTUpIDw8IDIpIHwgKGJ5dGVzW2kgKyAyXSA+PiA2KV07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1tieXRlc1tpICsgMl0gJiA2M107CiAgICAgICAgfQogICAgICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgJz0nOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgJz09JzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJhc2U2NDsKICAgIH07CgogICAgY29uc3QgbGFzdEJsb2JNYXAgPSBuZXcgTWFwKCk7DQogICAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gbmV3IE1hcCgpOw0KICAgIGZ1bmN0aW9uIGdldFRyYW5zcGFyZW50QmxvYkZvcih3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucykgew0KICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkgew0KICAgICAgICAgICAgY29uc3QgaWQgPSBgJHt3aWR0aH0tJHtoZWlnaHR9YDsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgaWYgKHRyYW5zcGFyZW50QmxvYk1hcC5oYXMoaWQpKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNwYXJlbnRCbG9iTWFwLmdldChpZCk7DQogICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsNCiAgICAgICAgICAgICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgnMmQnKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0geWllbGQgYmxvYi5hcnJheUJ1ZmZlcigpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7DQogICAgICAgICAgICAgICAgdHJhbnNwYXJlbnRCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICByZXR1cm4gYmFzZTY0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgY29uc3Qgd29ya2VyID0gc2VsZjsNCiAgICB3b3JrZXIub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgY29uc3QgeyBpZCwgYml0bWFwLCB3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucyB9ID0gZS5kYXRhOw0KICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zKTsNCiAgICAgICAgICAgICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCcyZCcpOw0KICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoYml0bWFwLCAwLCAwKTsNCiAgICAgICAgICAgICAgICBiaXRtYXAuY2xvc2UoKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBibG9iLnR5cGU7DQogICAgICAgICAgICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSB5aWVsZCBibG9iLmFycmF5QnVmZmVyKCk7DQogICAgICAgICAgICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsNCiAgICAgICAgICAgICAgICBpZiAoIWxhc3RCbG9iTWFwLmhhcyhpZCkgJiYgKHlpZWxkIHRyYW5zcGFyZW50QmFzZTY0KSA9PT0gYmFzZTY0KSB7DQogICAgICAgICAgICAgICAgICAgIGxhc3RCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7DQogICAgICAgICAgICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgaWQsDQogICAgICAgICAgICAgICAgICAgIHR5cGUsDQogICAgICAgICAgICAgICAgICAgIGJhc2U2NCwNCiAgICAgICAgICAgICAgICAgICAgd2lkdGgsDQogICAgICAgICAgICAgICAgICAgIGhlaWdodCwNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfTsKCn0pKCk7Cgo=",null,!1);class CanvasManager{constructor(e){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(e,t)=>{!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(e)||this.pendingCanvasMutations.set(e,[]),this.pendingCanvasMutations.get(e).push(t)};const{sampling:t="all",win:r,blockClass:o,blockSelector:n,recordCanvas:i,dataURLOptions:a}=e;this.mutationCb=e.mutationCb,this.mirror=e.mirror,i&&"all"===t&&this.initCanvasMutationObserver(r,o,n),i&&"number"==typeof t&&this.initCanvasFPSObserver(t,r,o,n,{dataURLOptions:a})}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}initCanvasFPSObserver(e,t,r,o,n){const i=initCanvasContextObserver(t,r,o),a=new Map,s=new WorkerFactory;s.onmessage=e=>{const{id:t}=e.data;if(a.set(t,!1),!("base64"in e.data))return;const{base64:r,type:o,width:n,height:i}=e.data;this.mutationCb({id:t,type:CanvasContext["2D"],commands:[{property:"clearRect",args:[0,0,n,i]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:r}],type:o}]},0,0]}]})};const c=1e3/e;let d,l=0;const u=e=>{l&&e-l<c||(l=e,(()=>{const e=[];return t.document.querySelectorAll("canvas").forEach((t=>{isBlocked(t,r,o,!0)||e.push(t)})),e})().forEach((e=>__awaiter(this,void 0,void 0,(function*(){var t;const r=this.mirror.getId(e);if(a.get(r))return;if(a.set(r,!0),["webgl","webgl2"].includes(e.__context)){const r=e.getContext(e.__context);!1===(null===(t=null==r?void 0:r.getContextAttributes())||void 0===t?void 0:t.preserveDrawingBuffer)&&(null==r||r.clear(r.COLOR_BUFFER_BIT))}const o=yield createImageBitmap(e);s.postMessage({id:r,bitmap:o,width:e.width,height:e.height,dataURLOptions:n.dataURLOptions},[o])}))))),d=requestAnimationFrame(u)};d=requestAnimationFrame(u),this.resetObservers=()=>{i(),cancelAnimationFrame(d)}}initCanvasMutationObserver(e,t,r){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const o=initCanvasContextObserver(e,t,r),n=initCanvas2DMutationObserver(this.processMutation.bind(this),e,t,r),i=initCanvasWebGLMutationObserver(this.processMutation.bind(this),e,t,r,this.mirror);this.resetObservers=()=>{o(),n(),i()}}startPendingCanvasMutationFlusher(){requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}startRAFTimestamping(){const e=t=>{this.rafStamps.latestId=t,requestAnimationFrame(e)};requestAnimationFrame(e)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach(((e,t)=>{const r=this.mirror.getId(t);this.flushPendingCanvasMutationFor(t,r)})),requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}flushPendingCanvasMutationFor(e,t){if(this.frozen||this.locked)return;const r=this.pendingCanvasMutations.get(e);if(!r||-1===t)return;const o=r.map((e=>__rest(e,["type"]))),{type:n}=r[0];this.mutationCb({id:t,type:n,commands:o}),this.pendingCanvasMutations.delete(e)}}class StylesheetManager{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new StyleSheetMirror,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,t){"_cssText"in t.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:t.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,t){if(0===e.length)return;const r={id:t,styleIds:[]},o=[];for(const t of e){let e;if(this.styleMirror.has(t))e=this.styleMirror.getId(t);else{e=this.styleMirror.add(t);const r=Array.from(t.rules||CSSRule);o.push({styleId:e,rules:r.map(((e,t)=>({rule:getCssRuleString(e),index:t})))})}r.styleIds.push(e)}o.length>0&&(r.styles=o),this.adoptedStyleSheetCb(r)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}function wrapEvent(e){return Object.assign(Object.assign({},e),{timestamp:Date.now()})}let wrappedEmit,takeFullSnapshot,canvasManager,recording=!1;const mirror=createMirror();function record(e={}){const{emit:t,checkoutEveryNms:r,checkoutEveryNth:o,blockClass:n="rr-block",blockSelector:i=null,ignoreClass:a="rr-ignore",maskTextClass:s="rr-mask",maskTextSelector:c=null,inlineStylesheet:d=!0,maskAllInputs:l,maskInputOptions:u,slimDOMOptions:p,maskInputFn:h,maskTextFn:g,hooks:m,packFn:f,sampling:I={},dataURLOptions:y={},mousemoveWait:S,recordCanvas:C=!1,recordCrossOriginIframes:v=!1,userTriggeredOnInput:b=!1,collectFonts:E=!1,inlineImages:A=!1,plugins:T,keepIframeSrcFn:R=(()=>!1),ignoreCSSAttributes:w=new Set([])}=e,k=!v||window.parent===window;let B=!1;if(!k)try{window.parent.document,B=!1}catch(e){B=!0}if(k&&!t)throw new Error("emit function is required");void 0!==S&&void 0===I.mousemove&&(I.mousemove=S),mirror.reset();const M=!0===l?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==u?u:{password:!0},N=!0===p||"all"===p?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===p,headMetaDescKeywords:"all"===p}:p||{};let O;polyfill();let D=0;const _=e=>{for(const t of T||[])t.eventProcessor&&(e=t.eventProcessor(e));return f&&(e=f(e)),e};wrappedEmit=(e,n)=>{var i;if(!(null===(i=mutationBuffers[0])||void 0===i?void 0:i.isFrozen())||e.type===EventType.FullSnapshot||e.type===EventType.IncrementalSnapshot&&e.data.source===IncrementalSource.Mutation||mutationBuffers.forEach((e=>e.unfreeze())),k)null==t||t(_(e),n);else if(B){const t={type:"rrweb",event:_(e),isCheckout:n};window.parent.postMessage(t,"*")}if(e.type===EventType.FullSnapshot)O=e,D=0;else if(e.type===EventType.IncrementalSnapshot){if(e.data.source===IncrementalSource.Mutation&&e.data.isAttachIframe)return;D++;const t=o&&D>=o,n=r&&e.timestamp-O.timestamp>r;(t||n)&&takeFullSnapshot(!0)}};const P=e=>{wrappedEmit(wrapEvent({type:EventType.IncrementalSnapshot,data:Object.assign({source:IncrementalSource.Mutation},e)}))},L=e=>wrappedEmit(wrapEvent({type:EventType.IncrementalSnapshot,data:Object.assign({source:IncrementalSource.Scroll},e)})),F=e=>wrappedEmit(wrapEvent({type:EventType.IncrementalSnapshot,data:Object.assign({source:IncrementalSource.CanvasMutation},e)})),x=new StylesheetManager({mutationCb:P,adoptedStyleSheetCb:e=>wrappedEmit(wrapEvent({type:EventType.IncrementalSnapshot,data:Object.assign({source:IncrementalSource.AdoptedStyleSheet},e)}))}),W=new IframeManager({mirror:mirror,mutationCb:P,stylesheetManager:x,recordCrossOriginIframes:v,wrappedEmit:wrappedEmit});for(const e of T||[])e.getMirror&&e.getMirror({nodeMirror:mirror,crossOriginIframeMirror:W.crossOriginIframeMirror,crossOriginIframeStyleMirror:W.crossOriginIframeStyleMirror});canvasManager=new CanvasManager({recordCanvas:C,mutationCb:F,win:window,blockClass:n,blockSelector:i,mirror:mirror,sampling:I.canvas,dataURLOptions:y});const U=new ShadowDomManager({mutationCb:P,scrollCb:L,bypassOptions:{blockClass:n,blockSelector:i,maskTextClass:s,maskTextSelector:c,inlineStylesheet:d,maskInputOptions:M,dataURLOptions:y,maskTextFn:g,maskInputFn:h,recordCanvas:C,inlineImages:A,sampling:I,slimDOMOptions:N,iframeManager:W,stylesheetManager:x,canvasManager:canvasManager,keepIframeSrcFn:R},mirror:mirror});takeFullSnapshot=(e=!1)=>{var t,r,o,a,l,u;wrappedEmit(wrapEvent({type:EventType.Meta,data:{href:window.location.href,width:getWindowWidth(),height:getWindowHeight()}}),e),x.reset(),mutationBuffers.forEach((e=>e.lock()));const p=snapshot(document,{mirror:mirror,blockClass:n,blockSelector:i,maskTextClass:s,maskTextSelector:c,inlineStylesheet:d,maskAllInputs:M,maskTextFn:g,slimDOM:N,dataURLOptions:y,recordCanvas:C,inlineImages:A,onSerialize:e=>{isSerializedIframe(e,mirror)&&W.addIframe(e),isSerializedStylesheet(e,mirror)&&x.trackLinkElement(e),hasShadowRoot(e)&&U.addShadowRoot(e.shadowRoot,document)},onIframeLoad:(e,t)=>{W.attachIframe(e,t),U.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{x.attachLinkElement(e,t)},keepIframeSrcFn:R});if(!p)return console.warn("Failed to snapshot the document");wrappedEmit(wrapEvent({type:EventType.FullSnapshot,data:{node:p,initialOffset:{left:void 0!==window.pageXOffset?window.pageXOffset:(null===document||void 0===document?void 0:document.documentElement.scrollLeft)||(null===(r=null===(t=null===document||void 0===document?void 0:document.body)||void 0===t?void 0:t.parentElement)||void 0===r?void 0:r.scrollLeft)||(null===(o=null===document||void 0===document?void 0:document.body)||void 0===o?void 0:o.scrollLeft)||0,top:void 0!==window.pageYOffset?window.pageYOffset:(null===document||void 0===document?void 0:document.documentElement.scrollTop)||(null===(l=null===(a=null===document||void 0===document?void 0:document.body)||void 0===a?void 0:a.parentElement)||void 0===l?void 0:l.scrollTop)||(null===(u=null===document||void 0===document?void 0:document.body)||void 0===u?void 0:u.scrollTop)||0}}})),mutationBuffers.forEach((e=>e.unlock())),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&x.adoptStyleSheets(document.adoptedStyleSheets,mirror.getId(document))};try{const e=[];e.push(on("DOMContentLoaded",(()=>{wrappedEmit(wrapEvent({type:EventType.DomContentLoaded,data:{}}))})));const t=e=>{var t;return initObservers({mutationCb:P,mousemoveCb:(e,t)=>wrappedEmit(wrapEvent({type:EventType.IncrementalSnapshot,data:{source:t,positions:e}})),mouseInteractionCb:e=>wrappedEmit(wrapEvent({type:EventType.IncrementalSnapshot,data:Object.assign({source:IncrementalSource.MouseInteraction},e)})),scrollCb:L,viewportResizeCb:e=>wrappedEmit(wrapEvent({type:EventType.IncrementalSnapshot,data:Object.assign({source:IncrementalSource.ViewportResize},e)})),inputCb:e=>wrappedEmit(wrapEvent({type:EventType.IncrementalSnapshot,data:Object.assign({source:IncrementalSource.Input},e)})),mediaInteractionCb:e=>wrappedEmit(wrapEvent({type:EventType.IncrementalSnapshot,data:Object.assign({source:IncrementalSource.MediaInteraction},e)})),styleSheetRuleCb:e=>wrappedEmit(wrapEvent({type:EventType.IncrementalSnapshot,data:Object.assign({source:IncrementalSource.StyleSheetRule},e)})),styleDeclarationCb:e=>wrappedEmit(wrapEvent({type:EventType.IncrementalSnapshot,data:Object.assign({source:IncrementalSource.StyleDeclaration},e)})),canvasMutationCb:F,fontCb:e=>wrappedEmit(wrapEvent({type:EventType.IncrementalSnapshot,data:Object.assign({source:IncrementalSource.Font},e)})),selectionCb:e=>{wrappedEmit(wrapEvent({type:EventType.IncrementalSnapshot,data:Object.assign({source:IncrementalSource.Selection},e)}))},blockClass:n,ignoreClass:a,maskTextClass:s,maskTextSelector:c,maskInputOptions:M,inlineStylesheet:d,sampling:I,recordCanvas:C,inlineImages:A,userTriggeredOnInput:b,collectFonts:E,doc:e,maskInputFn:h,maskTextFn:g,keepIframeSrcFn:R,blockSelector:i,slimDOMOptions:N,dataURLOptions:y,mirror:mirror,iframeManager:W,stylesheetManager:x,shadowDomManager:U,canvasManager:canvasManager,ignoreCSSAttributes:w,plugins:(null===(t=null==T?void 0:T.filter((e=>e.observer)))||void 0===t?void 0:t.map((e=>({observer:e.observer,options:e.options,callback:t=>wrappedEmit(wrapEvent({type:EventType.Plugin,data:{plugin:e.name,payload:t}}))}))))||[]},m)};W.addLoadListener((r=>{e.push(t(r.contentDocument))}));const r=()=>{takeFullSnapshot(),e.push(t(document)),recording=!0};return"interactive"===document.readyState||"complete"===document.readyState?r():e.push(on("load",(()=>{wrappedEmit(wrapEvent({type:EventType.Load,data:{}})),r()}),window)),()=>{e.forEach((e=>e())),recording=!1}}catch(e){console.warn(e)}}var NodeType$1,NodeType;record.addCustomEvent=(e,t)=>{if(!recording)throw new Error("please add custom event after start recording");wrappedEmit(wrapEvent({type:EventType.Custom,data:{tag:e,payload:t}}))},record.freezePage=()=>{mutationBuffers.forEach((e=>e.freeze()))},record.takeFullSnapshot=e=>{if(!recording)throw new Error("please take full snapshot after start recording");takeFullSnapshot(e)},record.mirror=mirror,function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(NodeType$1||(NodeType$1={})),function(e){e[e.PLACEHOLDER=0]="PLACEHOLDER",e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",e[e.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",e[e.ENTITY_NODE=6]="ENTITY_NODE",e[e.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE",e[e.DOCUMENT_NODE=9]="DOCUMENT_NODE",e[e.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",e[e.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE"}(NodeType||(NodeType={}));var u8=Uint8Array,u16=Uint16Array,u32=Uint32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),freb=function(e,t){for(var r=new u16(31),o=0;o<31;++o)r[o]=t+=1<<e[o-1];var n=new u32(r[30]);for(o=1;o<30;++o)for(var i=r[o];i<r[o+1];++i)n[i]=i-r[o]<<5|o;return[r,n]},_a=freb(fleb,2),fl=_a[0],revfl=_a[1];fl[28]=258,revfl[258]=28,freb(fdeb,0);for(var rev=new u16(32768),i=0;i<32768;++i){var x=(43690&i)>>>1|(21845&i)<<1;x=(52428&x)>>>2|(13107&x)<<2,x=(61680&x)>>>4|(3855&x)<<4,rev[i]=((65280&x)>>>8|(255&x)<<8)>>>1}for(var flt=new u8(288),i=0;i<144;++i)flt[i]=8;for(var i=144;i<256;++i)flt[i]=9;for(var i=256;i<280;++i)flt[i]=7;for(var i=280;i<288;++i)flt[i]=8;for(var fdt=new u8(32),i=0,n,t;i<32;++i)fdt[i]=5;
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */t=n||(n={}),t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped";let eventsMatrix=[[]];var replay=()=>{record({emit(e,t){t&&(eventsMatrix.push([]),eventsMatrix.length>16&&(eventsMatrix=eventsMatrix.slice(12)));eventsMatrix[eventsMatrix.length-1].push(e)},checkoutEveryNms:3e4})};const cacheMapSize=getConfig().cacheMapSize,cacheMap=new Map([]);cacheMap.set("BasicIndicator",[]),cacheMap.set("InterfaceIndicator",[]),cacheMap.set("ResourceIndicator",[]),cacheMap.set("ResourceError",[]),cacheMap.set("JavaScriptError",[]),cacheMap.set("PromiseError",[]),cacheMap.set("BasicBehavior",[]),cacheMap.set("ClickBehavior",[]),cacheMap.set("PageSkipBehavior",[]),cacheMap.set("RoutingSkipBehavior",[]);let count=0;const reportAll=()=>{for(const e of cacheMap.keys())cacheMap.get(e).length>0&&(realTimeReport(e,cacheMap.get(e)),cacheMap.set(e,[]));count=0};onBeforeUnload(reportAll),setInterval(reportAll,getConfig().reportTimeInterval);const realTimeReport=(e,t)=>{switch(e){case"BasicIndicator":postPerformancesBasicindicators({requestBody:t}).catch((e=>{console.log(e)}));break;case"InterfaceIndicator":postPerformancesInterfaceindicators({requestBody:t}).catch((e=>{console.log(e)}));break;case"ResourceIndicator":postPerformancesResourceindicators({requestBody:t}).catch((e=>{console.log(e)}));break;case"ResourceError":postErrorsResourceerrors({requestBody:t}).catch((e=>{console.log(e)}));break;case"JavaScriptError":postErrorsJavascripterrors({requestBody:t}).catch((e=>{console.log(e)}));break;case"PromiseError":postErrorsPromiseerrors({requestBody:t}).catch((e=>{console.log(e)}));break;case"VueError":break;case"BasicBehavior":postBehaviorsBasicbehaviors({requestBody:t}).catch((e=>{console.log(e)}));break;case"ClickBehavior":postBehaviorsClickbehaviors({requestBody:t}).catch((e=>{console.log(e)}));break;case"PageSkipBehavior":postBehaviorsPageskipbehaviors({requestBody:t}).catch((e=>{console.log(e)}));break;case"RoutingSkipBehavior":postBehaviorsRoutingskipbehaviors({requestBody:t}).catch((e=>{console.log(e)}));break;default:throw new Error(`Unknown monitorName: ${e}`)}},stagingReport=(e,t)=>{cacheMap.get(e).push(t),count++,count>=cacheMapSize&&reportAll();if(["ResourceError","JavaScriptError","PromiseError"].find((t=>t===e))){const e=eventsMatrix.length,r=eventsMatrix[e-2].concat(eventsMatrix[e-1]);let o={eventId:t.eventId,appId:t.appId,time:getTimeStamp(),userId:t.userID,events:r};postReplayReport({requestBody:o}).catch((e=>{console.log(e)}))}};var clickBehavior=()=>{["mousedown","touchstart"].forEach((e=>{let t;window.addEventListener(e,(e=>{clearTimeout(t),t=setTimeout((()=>{const t=e.target,{top:r,left:o}=t?.getBoundingClientRect();stagingReport("ClickBehavior",{mainType:ClickBehavior.mainType.ClickBehavior,subType:ClickBehavior.subType.ClickBehavior,...getBasicParams(),top:r,left:o,target:t?.tagName,html:document.documentElement.outerHTML,inner:t?.outerHTML})}),500)}))}))},pageAccessDepth=()=>{onBeforeUnload((()=>{realTimeReport("BasicBehavior",[{mainType:BasicBehavior.mainType.BasicBehavior,subType:BasicBehavior.subType.PageAccessDepth,...getBasicParams(),value:(document.documentElement.scrollTop+document.documentElement.clientHeight)/document.documentElement.scrollHeight}])}))};let isLoaded=!1,loadedTime=0;var load=()=>{const e=new PerformanceObserver((t=>{const r=t.getEntries();for(const t of r)t.name===getPageUrl()&&(e.disconnect(),stagingReport("BasicIndicator",{mainType:BasicIndicator.mainType.LoadIndicator,subType:BasicIndicator.subType.FullLoad,...getBasicParams(),value:t.loadEventStart}),loadedTime=t.loadEventStart,isLoaded=!0)}));e.observe({type:"navigation",buffered:!0})},pageDwellTime=()=>{onBeforeUnload((()=>{const e=performance.now();realTimeReport("BasicBehavior",[{mainType:BasicBehavior.mainType.BasicBehavior,subType:BasicBehavior.subType.PageDwellTime,...getBasicParams(),value:e-loadedTime}])}))};function initPageSkipBehavior(){let e="";window.addEventListener("popstate",(()=>{const t=getPageUrl();stagingReport("PageSkipBehavior",{mainType:PageSkipBehavior.mainType.PageSkipBehavior,subType:PageSkipBehavior.subType.PageSkipBehavior,...getBasicParams(),from:e,to:t}),e=t}),!0);let t="";window.addEventListener("hashchange",(e=>{const r=e.newURL;stagingReport("PageSkipBehavior",{mainType:PageSkipBehavior.mainType.PageSkipBehavior,subType:PageSkipBehavior.subType.PageSkipBehavior,...getBasicParams(),from:t,to:r}),t=r}),!0)}var pageView=()=>{stagingReport("BasicBehavior",{mainType:BasicBehavior.mainType.BasicBehavior,subType:BasicBehavior.subType.PV,...getBasicParams(),value:1})},behavior=()=>{monitoring(clickBehavior,pageAccessDepth,pageDwellTime,initPageSkipBehavior,pageView)},javaScriptError=()=>{window.onerror=(e,t,r,o,n)=>{stagingReport("JavaScriptError",{mainType:JavaScriptError.mainType.JavaScriptError,subType:JavaScriptError.subType.JavaScriptError,...getBasicParams(),url:t||"",msg:"string"==typeof e?e:JSON.stringify(e),line:r||-1,column:o||-1,errorTime:getTimeStamp(),stack:n?.stack||"no stack trace available"})}},promiseError=()=>{window.addEventListener("unhandledrejection",(e=>{const t=getTimeStamp();stagingReport("PromiseError",{mainType:PromiseError.mainType.PromiseError,subType:PromiseError.subType.PromiseError,pageUrl:getPageUrl(),userID:getUserID(),msg:e.reason?.msg??"",stack:e.reason?.stack??"",errorTime:t,appId:getAppId(),eventId:md5.hex(getAppId()+getUserID()+t)})}))},resourceError=()=>{window.addEventListener("error",(e=>{const t=e.target;if(t&&(t.src||t.href)){const e=t.src||t.href;stagingReport("ResourceError",{mainType:ResourceError.mainType.ResourceError,subType:ResourceError.subType.ResourceError,...getBasicParams(),errorTime:getTimeStamp(),resourceType:t.tagName,html:document.documentElement.outerHTML,path:e})}}),!0)},mistaken=()=>{monitoring(javaScriptError,promiseError,resourceError)},contentLayoutShift=()=>{let e=0;const t=new PerformanceObserver((t=>{const r=t.getEntries();for(const t of r)t.hadRecentInput||(e+=t.value)}));t.observe({type:"layout-shift",buffered:!0});const r=onHidden((()=>{t.takeRecords(),t.disconnect(),r(),stagingReport("BasicIndicator",{mainType:BasicIndicator.mainType.Performance,subType:BasicIndicator.subType.LayoutShift,...getBasicParams(),value:e})}))},firstContentfulPaint=()=>{const e=new PerformanceObserver((t=>{const r=t.getEntries();for(const t of r)"first-contentful-paint"===t.name&&(e.disconnect(),stagingReport("BasicIndicator",{mainType:BasicIndicator.mainType.Performance,subType:BasicIndicator.subType.FirstContentfulPaint,...getBasicParams(),value:t.startTime}))}));e.observe({type:"paint",buffered:!0})},firstPaint=()=>{const e=new PerformanceObserver((t=>{const r=t.getEntries();for(const t of r)"first-paint"===t.name&&(e.disconnect(),stagingReport("BasicIndicator",{mainType:BasicIndicator.mainType.Performance,subType:BasicIndicator.subType.FirstPaint,...getBasicParams(),value:t.startTime}))}));e.observe({type:"paint",buffered:!0})};let isLCPDone=!1;var largestContentfulPaint=()=>{const e=new PerformanceObserver((t=>{const r=t.getEntries();for(const t of r)""===t.name&&(e.disconnect(),stagingReport("BasicIndicator",{mainType:BasicIndicator.mainType.Performance,subType:BasicIndicator.subType.LargestContentfulPaint,...getBasicParams(),value:t.startTime}),isLCPDone=!0)}));e.observe({type:"largest-contentful-paint",buffered:!0})},basicIndicator=()=>{monitoring(firstContentfulPaint,firstPaint,largestContentfulPaint,contentLayoutShift)};const viewportWidth=window.innerWidth,viewportHeight=window.innerHeight;let entries=[];const isInScreen=e=>{const t=e.getBoundingClientRect();return t.left<viewportWidth&&t.top<viewportHeight},needToCalculate=e=>"none"!==window.getComputedStyle(e).display&&!("IMG"===e.tagName&&e.width<2&&e.height<2),isInclude=(e,t)=>!(!e||e===document.documentElement)&&(!!t.includes(e)||isInclude(e.parentElement,t)),getRenderTime=()=>{let e=0;return entries.forEach((t=>{for(const r of t.children)if(isInScreen(r)&&t.startTime>e&&needToCalculate(r)){e=t.startTime.valueOf();break}})),performance.getEntriesByType("resource").forEach((t=>{"img"===t.initiatorType&&t.fetchStart<e&&t.responseEnd>e&&(e=t.responseEnd)})),e};let timer;const checkDOMChange=e=>{clearInterval(timer),timer=setInterval((()=>{isLoaded&&isLCPDone&&(e&&e.disconnect(),stagingReport("BasicIndicator",{mainType:BasicIndicator.mainType.DrawIndicator,subType:BasicIndicator.subType.FirstScreenLoad,...getBasicParams(),value:getRenderTime().valueOf()}),clearInterval(timer),entries=[])}),500)};var firstScreenLoad=()=>{const e=["STYLE","SCRIPT","LINK","META"],t=new MutationObserver((r=>{checkDOMChange(t);const o={startTime:0,children:[]};requestAnimationFrame((()=>{o.startTime=performance.now()}));for(const t of r)t.addedNodes.length&&t.addedNodes.forEach((t=>{1!==t.nodeType||e.includes(t.tagName)||isInclude(t,o.children)||o.children.push(t)}));o.children.length&&entries.push(o)}));t.observe(document,{childList:!0,subtree:!0})},drawIndicator=()=>{monitoring(firstScreenLoad)},interfaceIndictor$1=()=>{const e=XMLHttpRequest.prototype.open,t=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(t,r,o,n,i){this.openData={method:t,url:r,async:o,username:n,password:i},e.call(this,t,r,o,n,i)},XMLHttpRequest.prototype.send=function(e){const r=Date.now(),o=e=>{const t=Date.now()-r;stagingReport("InterfaceIndicator",{mainType:BasicIndicator.mainType.InterfaceIndicator,subType:BasicIndicator.subType.InterfaceIndicator,...getBasicParams(),duration:t,method:this.openData.method,statusCode:this.status,url:this.openData.url.toString(),data:this.responseText}),this.removeEventListener("load",o,!0),this.removeEventListener("error",o,!0),this.removeEventListener("abort",o,!0)};this.addEventListener("load",o,!0),this.addEventListener("error",o,!0),this.addEventListener("abort",o,!0),t.call(this,e)};const r=window.fetch;window.fetch=function(e,t){const o={startTime:Date.now(),endTime:0,duration:0,statusCode:0,success:!1,url:e.toString(),method:(t?.method||"GET").toUpperCase(),data:""};return r(e,t).then((async e=>{o.endTime=Date.now(),o.duration=o.endTime-o.startTime;const t=e.clone();return o.statusCode=t.status,o.success=t.ok,o.data=await t.text(),stagingReport("InterfaceIndicator",{mainType:BasicIndicator.mainType.InterfaceIndicator,subType:BasicIndicator.subType.InterfaceIndicator,...getBasicParams(),...o}),e})).catch((e=>{throw o.endTime=Date.now(),o.duration=o.endTime-o.startTime,o.statusCode=0,o.success=!1,stagingReport("InterfaceIndicator",{mainType:BasicIndicator.mainType.InterfaceIndicator,subType:BasicIndicator.subType.InterfaceIndicator,...getBasicParams(),...o}),e}))}},interfaceIndictor=()=>{monitoring(interfaceIndictor$1)},domContentLoaded=()=>{const e=new PerformanceObserver((t=>{const r=t.getEntries();for(const t of r)t.name===getPageUrl()&&(e.disconnect(),stagingReport("BasicIndicator",{mainType:BasicIndicator.mainType.LoadIndicator,subType:BasicIndicator.subType.DOMContentLoaded,...getBasicParams(),value:t.domContentLoadedEventStart}))}));e.observe({type:"navigation",buffered:!0})},loadIndicator=()=>{monitoring(domContentLoaded,load)};let frame=0,lastSecond=performance.now();const calculateFPS=()=>{frame++;const e=performance.now();lastSecond+1e3<=e&&(stagingReport("BasicIndicator",{mainType:4,subType:4001,...getBasicParams(),value:Math.round(1e3*frame/(e-lastSecond))}),frame=0,lastSecond=e),requestAnimationFrame(calculateFPS)};var operationIndicator=()=>{monitoring(calculateFPS)},resourceIndicator$1=()=>{new PerformanceObserver((e=>{for(const t of e.getEntries())"xmlhttprequest"!==t.initiatorType&&stagingReport("ResourceIndicator",{mainType:BasicIndicator.mainType.ResourceIndicator,subType:BasicIndicator.subType.ResourceIndicator,...getBasicParams(),url:t.name,duration:t.duration,dns:t.domainLookupEnd-t.domainLookupStart,tcp:t.connectEnd-t.connectStart,redirect:t.redirectEnd-t.redirectStart,ttfb:t.responseStart,protocol:t.nextHopProtocol,resourceSize:t.decodedBodySize,isCache:0===t.transferSize||0!==t.transferSize&&0===t.encodedBodySize,bodySize:t.transferSize,headerSize:t.transferSize-t.encodedBodySize})})).observe({type:"resource",buffered:!0})},resourceIndicator=()=>{monitoring(resourceIndicator$1)},performance$1=()=>{monitoring(basicIndicator,drawIndicator,interfaceIndictor,loadIndicator,operationIndicator,resourceIndicator)},recall=()=>{monitoring(replay)},startMonitoring=()=>{monitoring(behavior,mistaken,performance$1,recall)};const createMonitor=e=>{setConfig(e),startMonitoring()};export{createMonitor};
